<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head >
        <h:outputStylesheet library="css" name="sale_bill_five_five_custom_3.css" />
    </h:head>
    <h:body>


        <p:outputLabel value="Medicines/Devices" ></p:outputLabel>
        <p:autoComplete
            accesskey="i"
            class="w-100"
            inputStyleClass="w-100"
            forceSelection="true"
            id="acStock"
            maxResults="10"
            minQueryLength="3"
            value="#{pharmacyIssueController.stockDto}"
            completeMethod="#{pharmacyIssueController.completeAvailableStocksDto}"
            converter="#{pharmacyIssueController.stockDtoConverter}"
            var="i"
            itemLabel="#{i.itemName}"
            itemValue="#{i}" >
            <p:ajax event="focus" process="acStock :#{p:resolveFirstComponentWithId('acDept',view).clientId}"  ></p:ajax>
            <p:ajax event="itemSelect"
                    listener="#{pharmacyIssueController.handleSelect}"
                    update="txtQty txtQtyDisplay txtRate txtPRate txtPurchaseRate txtCostRate txtPVal txtRVal txtCostVal txtIssueVal focusQty" ></p:ajax>
        </p:autoComplete>
        </div>
        <div class="col-2">
            <p:outputLabel value="Quantity" ></p:outputLabel>
            <p:inputText
                autocomplete="off"
                accesskey="q"
                id="txtQty"
                onfocus="this.select()"
                value="#{pharmacyIssueController.qty}"
                class="w-100">
                <f:convertNumber integerOnly="#{!pharmacyIssueController.stockDto.allowFractions}" />
                <p:ajax
                    event="keyup"
                    listener="#{pharmacyIssueController.calculateBillItemAtQtyChange}"
                    process="acStock txtQty :#{p:resolveFirstComponentWithId('acDept',view).clientId}"
                    update="txtQtyDisplay txtRate txtPRate txtPurchaseRate txtCostRate txtPVal txtRVal txtCostVal txtIssueVal" ></p:ajax>
                <p:ajax event="blur"  listener="#{pharmacyIssueController.calculateBillItemListner}" process="acStock txtQty :#{p:resolveFirstComponentWithId('acDept',view).clientId}" update="txtQtyDisplay txtRate txtPRate txtPurchaseRate txtCostRate txtPVal txtRVal txtCostVal txtIssueVal" ></p:ajax>
            </p:inputText>
            <p:keyFilter for="txtQty" mask="#{pharmacyIssueController.stockDto.allowFractions ? 'num' : 'int'}" />
        </div>
  


    </h:body>
</html>
