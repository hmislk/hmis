<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
    </h:head>
    <h:body>
        <ui:composition template="/admin/pricing/index.xhtml">
            <ui:define name="subcontent">
                <p:growl id="msg"/>
                <p:panel>
                    <f:facet name="header">
                        <h:outputText styleClass="fa fa-fw fa-money-bill-wave"></h:outputText>
                        <h:outputText value="Upload to Add Collection Centre Fees by Item Code" styleClass="m-2"></h:outputText>
                    </f:facet>
                    <p:panel styleClass="mb-3">
                        <f:facet name="header">
                            <h:outputText value="Description" />
                        </f:facet>
                        <h:outputText value="This utility creates NEW fee records for a selected Collection Centre. " />
                        <h:outputText value="Upload an Excel file (.xlsx) with item codes and fee values. " />
                        <h:outputText value="The system will find existing items by their code and create new fee entries for the selected Collection Centre. " />
                        <h:outputText value="This does NOT update existing fees - it adds new fee records." styleClass="text-warning" />
                    </p:panel>

                    <h:form id="upload" enctype="multipart/form-data">
                        <p:panelGrid columns="2" >
                            <p:outputLabel value="Collection Centre" for="acCc" ></p:outputLabel>
                            <p:autoComplete
                                value="#{itemController.collectionCentre}"
                                forceSelection="true" id="acCc"
                                completeMethod="#{institutionController.completeCollectingCenter}"
                                var="vt"
                                itemLabel="#{vt.name}"
                                itemValue="#{vt}"
                                maxResults="10"
                                class="w-100 mb-1"
                                inputStyleClass="form-control">
                                <p:column headerText="Code" style="padding: 6px;">#{vt.institutionCode}</p:column>
                                <p:column headerText="Name" style="padding: 6px;">#{vt.name}</p:column>
                            </p:autoComplete>
                        </p:panelGrid>

                        <p:fieldset legend="Excel File Format" styleClass="mb-3">
                            <h:panelGrid columns="2" styleClass="table table-bordered" columnClasses="text-center,">
                                <h:outputText value="Column" style="font-weight: bold;" />
                                <h:outputText value="Content" style="font-weight: bold;" />
                                <h:outputText value="A" />
                                <h:outputText value="Item Code (must match existing item codes in the system)" />
                                <h:outputText value="B" />
                                <h:outputText value="Fee Value (numeric, must be greater than 0)" />
                            </h:panelGrid>
                            <h:outputText value="Note: The first row is treated as a header and will be skipped." styleClass="text-info" />
                        </p:fieldset>


                        <p:fileUpload value="#{itemController.file}"
                                      mode="simple"
                                      label="Choose File"/>
                        <p:commandButton 
                            icon="fa fa-upload"
                            value="Upload and Add Fee Values"
                            action="#{itemController.uploadToAddCcFeesByItemCode()}"
                            ajax="false"/>


                        <p:inputTextarea  value="#{itemController.output}" class="w-100" rows="30" >

                        </p:inputTextarea>

                    </h:form>

                </p:panel>
            </ui:define>
        </ui:composition>
    </h:body>
</html>
