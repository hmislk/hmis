<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:na="http://xmlns.jcp.org/jsf/composite/template"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      xmlns:ez="http://xmlns.jcp.org/jsf/composite/ezcomp">


    <f:metadata >
        <f:viewParam name="id" value="#{patientReportController.encryptedPatientReportId}" />
        <f:viewAction action="#{patientReportController.preparePatientReportForReportLink()}" />
    </f:metadata>

    <h:body>
        <ui:composition template="/resources/template/template_contents_only.xhtml">
            <ui:define name="content">
                <h:outputStylesheet library="css" name="lab.css" ></h:outputStylesheet>

                <h:panelGroup rendered="#{patientReportController.currentPatientReport eq null}"  >
                    <na:link_expire />
                </h:panelGroup>

                <h:panelGroup rendered="#{patientReportController.currentPatientReport ne null}"  >
                    <div >

                        <style>
                            * {
                                margin: 0;
                                padding: 0;
                                box-sizing: border-box;
                            }

                            body {
                                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                                background: linear-gradient(135deg, #f0f9ff 0%, #ffffff 50%, #f0f9ff 100%);
                                min-height: 100vh;
                                padding: 20px;
                            }

                            .container {
                                max-width: 1200px;
                                margin: 0 auto;
                                background: white;
                                border-radius: 16px;
                                box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
                                overflow: hidden;
                                border: 1px solid #e5e7eb;
                            }

                            /* Header */
                            .header {
                                background: white;
                                padding: 24px;
                                text-align: center;
                                border-bottom: 1px solid #f3f4f6;
                            }

                            .logo-section {
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                margin-top: 8px;
                                margin-bottom: 8px;
                            }

                            .logo-icon {
                                width: 48px;
                                height: 48px;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                margin-right: 12px;
                            }

                            .logo-icon::before {
                                content: "‚ù§";
                                color: white;
                                font-size: 24px;
                            }

                            .logo-text h1 {
                                font-size: 24px;
                                font-weight: bold;
                                color: #1d4ed8;
                                line-height: 1;
                            }

                            .logo-text p {
                                font-size: 12px;
                                color: #6b7280;
                                font-weight: 500;
                                letter-spacing: 0.5px;
                            }

                            /* Welcome Section */
                            .welcome-section {
                                background: linear-gradient(to right, #dbeafe, #bfdbfe);
                                padding: 24px;
                                border-top: 4px solid #2563eb;
                            }

                            .welcome-title {
                                font-size: 20px;
                                font-weight: 600;
                                color: #1f2937;
                                margin-bottom: 12px;
                            }

                            .phone-info {
                                display: flex;
                                align-items: center;
                                color: #374151;
                            }

                            .phone-icon {
                                width: 16px;
                                height: 16px;
                                margin-right: 8px;
                                color: #2563eb;
                            }

                            .phone-icon::before {
                                content: "üìû";
                                font-size: 17px;
                            }

                            /* Table Section */
                            .table-section {
                                padding: 24px;
                                background: white;
                            }

                            .table-container {
                                overflow-x: auto;
                            }

                            table {
                                width: 100%;
                                border-collapse: collapse;
                            }

                            th {
                                text-align: left;
                                padding: 12px 8px;
                                font-weight: 600;
                                color: #374151;
                                border-bottom: 2px solid #e5e7eb;
                                font-size: 14px;
                            }

                            td {
                                padding: 16px 8px;
                                border-bottom: 1px solid #f3f4f6;
                                color: #1f2937;
                            }

                            tr:hover {
                                background-color: #f9fafb;
                            }

                            .download-btn {
                                background: #2563eb;
                                color: white;
                                border: none;
                                padding: 0px 16px;
                                border-radius: 8px;
                                font-weight: 500;
                                cursor: pointer;
                                transition: all 0.2s;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                gap: 2px;
                                font-size: 12px;
                            }

                            .download-btn:hover {
                                background: #1d4ed8;
                                transform: translateY(-1px);
                            }

                            .download-btn::before {
                                font-size: 18px;
                            }

                            /* Mobile Cards */
                            .mobile-cards {
                                display: none;
                            }

                            .test-card {
                                background: #f9fafb;
                                border-radius: 8px;
                                padding: 16px;
                                margin-bottom: 16px;
                                border: 1px solid #e5e7eb;
                            }

                            .card-row {
                                display: flex;
                                align-items: center;
                                margin-bottom: 12px;
                            }

                            .card-row:last-child {
                                margin-bottom: 0;
                            }

                            .card-icon {
                                width: 16px;
                                height: 16px;
                                margin-right: 8px;
                            }

                            .card-label {
                                font-size: 14px;
                                color: #6b7280;
                                margin-right: 8px;
                            }

                            .card-value {
                                font-weight: 500;
                                color: #1f2937;
                            }

                            .mobile-download-btn {
                                width: 100%;
                                background: #2563eb;
                                color: white;
                                border: none;
                                padding: 2px;
                                border-radius: 8px;
                                font-weight: 500;
                                cursor: pointer;
                                transition: all 0.2s;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                gap: 8px;
                                margin-top: 2px;
                            }

                            .mobile-download-btn:hover {
                                background: #1d4ed8;
                                transform: translateY(-1px);
                            }

                            .mobile-download-btn::before {
                                font-size: 14px;
                            }

                            /* Footer */
                            .footer {
                                background: white;
                                padding: 16px;
                                text-align: center;
                                border-top: 1px solid #f3f4f6;
                                border-radius: 0 0 16px 16px;
                            }

                            .footer-content {
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                color: #6b7280;
                                font-size: 14px;
                            }

                            .footer-icon {
                                width: 16px;
                                height: 16px;
                                margin: 0 8px;
                            }

                            .footer-icon::before {
                                font-size: 14px;
                            }

                            .footer-brand {
                                font-weight: 600;
                                color: #374151;
                            }

                            /* Info Section */
                            .info-section {
                                background: white;
                                border-radius: 12px;
                                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
                                padding: 24px;
                                margin-top: 24px;
                                border: 1px solid #f3f4f6;
                            }

                            .info-title {
                                font-size: 18px;
                                font-weight: 600;
                                color: #1f2937;
                                margin-bottom: 16px;
                            }

                            .info-grid {
                                display: grid;
                                grid-template-columns: 1fr 1fr;
                                gap: 16px;
                            }

                            .info-item {
                                margin-bottom: 8px;
                                font-size: 14px;
                                color: #6b7280;
                            }

                            .info-item strong {
                                color: #1f2937;
                            }

                            /* Mobile Responsive */
                            @media (max-width: 768px) {
                                body {
                                    padding: 12px;
                                }

                                .header {
                                    padding: 16px;
                                }

                                .logo-text h1 {
                                    font-size: 24px;
                                }

                                .welcome-section {
                                    padding: 16px;
                                }

                                .welcome-title {
                                    font-size: 18px;
                                }

                                .table-section {
                                    padding: 16px;
                                }

                                .desktop-table {
                                    display: none;
                                }

                                .mobile-cards {
                                    display: block;
                                }

                                .info-grid {
                                    grid-template-columns: 1fr;
                                    gap: 12px;
                                }

                                .info-section {
                                    padding: 16px;
                                }
                            }

                            @media (max-width: 480px) {
                                .logo-section {
                                    flex-direction: column;
                                    gap: 8px;
                                }

                                .logo-icon {
                                    margin-right: 0;
                                    margin-bottom: 8px;
                                }

                                .phone-info {
                                    flex-direction: column;
                                    align-items: flex-start;
                                    gap: 4px;
                                }
                            }

                            @media print {
                                .labReport {
                                    position: static !important;
                                }
                                #divReportM {
                                    position: static !important;
                                }
                                /* Repeat for other elements as needed */
                            }
                            @media print {
                                .printingOnly{
                                    display: block !important;

                                }
                            }

                            @media print {
                                .printingOnly {
                                    display: block !important;
                                }
                                .screenOnly {
                                    display: none !important;
                                }
                            }

                            @media screen {
                                .printingOnly {
                                    display: none !important;
                                }
                                .screenOnly {
                                    display: block !important;
                                }
                            }
                        </style>

                        <div class="container">
                            <!-- Header -->
                            <div class="header">
                                <div class="logo-section gap-4">
                                    <div class="logo-icon">
                                        <img 
                                            src="#{configOptionApplicationController.getLongTextValueByKey('Laboratory Report SMS Interface Logo')}" 
                                            alt="Hospital Logo" 
                                            height="80" 
                                            width="80"/>
                                    </div>
                                    <div class="logo-text">
                                        <h1>#{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.institution.chequePrintingName}</h1>
                                    </div>
                                </div>
                            </div>

                            <!-- Welcome Section -->
                            <div class="welcome-section">
                                <h2 class="welcome-title">Hi <strong>#{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.patient.person.nameWithTitle}</strong>, Welcome to #{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.institution.chequePrintingName}</h2>
                                <div class="phone-info gap-2">
                                    <span class="phone-icon"></span>
                                    <span class="mt-3"><strong>Mobile: #{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.patient.person.mobile}</strong></span>
                                </div>
                            </div>

                            <!-- Table Section -->
                            <div class="table-section">
                                <!-- Desktop Table -->
                                <div class="desktop-table">
                                    <div class="table-container">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th>Bill No</th>
                                                    <th>Investigation Name</th>
                                                    <th>Date</th>
                                                    <th style="text-align: center;">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>#{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.deptId}</td>
                                                    <td><strong>#{patientReportController.currentPatientReport.patientInvestigation.investigation.name}</strong></td>
                                                    <td>
                                                        <h:outputLabel value="#{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.createdAt}" >
                                                            <f:convertDateTime pattern="yyyy-MM-dd" />
                                                        </h:outputLabel>
                                                    </td>
                                                    <td style="text-align: center;" class="d-flex justify-content-center">
                                                        <p:commandButton 
                                                            class="download-btn"
                                                            icon="fa fa-cloud-download"
                                                            value="Download" 
                                                            ajax="false" 
                                                            action="#"  >
                                                            <p:printer target="divPrint" ></p:printer>
                                                        </p:commandButton>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Mobile Cards -->
                                <div class="mobile-cards">
                                    <div class="test-card">
                                        <div class="card-row">
                                            <span class="card-icon">#</span>
                                            <span class="card-label">Bill No:</span>
                                            <span class="card-value">#{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.deptId}</span>
                                        </div>
                                        <div class="card-row">
                                            <span class="card-icon">üìÑ</span>
                                            <span class="card-label">Test Name:</span>
                                            <span class="card-value">#{patientReportController.currentPatientReport.patientInvestigation.investigation.name}</span>
                                        </div>
                                        <div class="card-row">
                                            <span class="card-icon">üìÖ</span>
                                            <span class="card-label">Date:</span>
                                            <span class="card-value">
                                                <h:outputLabel value="#{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.createdAt}" >
                                                    <f:convertDateTime pattern="yyyy-MM-dd" />
                                                </h:outputLabel>
                                            </span>
                                        </div>
                                        <p:commandButton 
                                            class="mobile-download-btn"
                                            icon="fa fa-cloud-download"
                                            value="Download" 
                                            ajax="false" 
                                            action="#"  >
                                            <p:printer target="divPrint" ></p:printer>
                                        </p:commandButton>
                                    </div>
                                </div>
                            </div>

                            <!-- Additional Information Section -->
                            <h:panelGroup rendered="#{configOptionApplicationController.getLongTextValueByKey('Laboratory Report SMS Interface - Show Contact Information on Footer',false)}">
                            <div class="info-section">
                                <h3 class="info-title">Contact Information</h3>
                                <div class="info-grid">
                                    <div>
                                        <div class="info-item"><strong>Opening:</strong> #{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.department.description}</div>
                                        <div class="info-item"><strong>Emergency Contact :</strong> #{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.department.telephone1}</div>
                                    </div>
                                    <div>
                                        <div class="info-item"><strong>Address :</strong> #{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.department.address}</div>
                                        <div class="info-item"><strong>Email :</strong> #{patientReportController.currentPatientReport.patientInvestigation.billItem.bill.department.email}</div>
                                    </div>
                                </div>
                            </div>
                                </h:panelGroup>
                            <!-- Footer -->
                            <div class="footer">
                                <div class="footer-content gap-2">
                                    <span>Powered by</span>
                                    <span class="footer-brand">
                                        <a href="https://carecode.lk/" target="_blank" >CareCode Solutions (Pvt) Ltd</a>
                                    </span>
                                </div>
                                <div class="footer-content">
                                    <span class="footer-icon">
                                        <img 
                                            src="#{configOptionApplicationController.getLongTextValueByKey('Laboratory Report SMS Interface Logo')}" 
                                            alt="CareCode Logo" 
                                            height="80" 
                                            width="80"/>
                                        <img src="https://i.ibb.co/KxgRR5b6/fcare.png" alt="CareCode Logo" />
                                    </span>
                                </div>
                            </div>
                        </div>


                        <div  class="printingOnly">
                            <h:panelGroup id="divPrint" class="d-flex justify-content-center mt-5">

                                <!--General-->
                                <h:panelGroup rendered="#{patientReportController.currentPatientReport.item.reportType eq 'General'}" >
                                    <div id="divReport"  class="labReport1" >
                                        <ez:common_report
                                            showBackground="true"
                                            commonReportFormat="#{patientReportController.currentPatientReport.reportFormat}"
                                            patientReport="#{patientReportController.currentPatientReport}"/>

                                        <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >

                                            <h:panelGroup
                                                rendered="#{prv.investigationItem.retired eq false}"
                                                layout="block" style="#{prv.investigationItem.cssStyle}; position:absolute;">
                                                <h:outputLabel
                                                    value="#{prv.lobValue}"
                                                    style="z-index: 1000;"
                                                    rendered="#{prv.investigationItem.ixItemType eq 'Value' and prv.investigationItem.ixItemValueType eq 'Memo' and prv.investigationItem.retired eq false}"
                                                    escape="false" />
                                            </h:panelGroup>
                                        </ui:repeat>
                                        <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >
                                            <h:panelGroup
                                                layout="block"
                                                rendered="#{prv.investigationItem.retired eq false}"
                                                style="#{prv.investigationItem.cssStyle}; position:absolute;">
                                                <h:outputLabel
                                                    value="#{prv.lobValue}"
                                                    rendered="#{prv.investigationItem.ixItemType eq 'Template' and prv.investigationItem.retired eq false}"
                                                    escape="false" />
                                            </h:panelGroup>
                                        </ui:repeat>
                                        <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >
                                            <h:panelGroup rendered="#{prv.investigationItem.retired eq false}"
                                                          layout="block" style="#{prv.investigationItem.cssStyle}; position:absolute;">
                                                <h:outputLabel
                                                    style="z-index: 1000;"
                                                    value="#{prv.strValue}"
                                                    rendered="#{prv.investigationItem.ixItemType eq 'Value' and prv.investigationItem.ixItemValueType eq 'Varchar'}"
                                                    escape="false" />
                                            </h:panelGroup>
                                        </ui:repeat>
                                        <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >
                                            <h:panelGroup rendered="#{prv.investigationItem.retired eq false}"
                                                          layout="block" style="#{prv.investigationItem.cssStyle}; position:absolute;">
                                                <h:outputLabel value="#{prv.displayValue}"
                                                               style="z-index: 1000;"
                                                               rendered="#{prv.investigationItem.ixItemType eq 'Value' and prv.investigationItem.ixItemValueType eq 'Double' and prv.investigationItem.retired eq false}"
                                                               escape="false" />
                                            </h:panelGroup>
                                        </ui:repeat>
                                        <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >
                                            <h:panelGroup rendered="#{prv.investigationItem.retired eq false}"
                                                          layout="block" style="#{prv.investigationItem.cssStyle}; position:absolute;">
                                                <h:outputLabel value="#{prv.strValue}"
                                                               style="z-index: 1000;"
                                                               rendered="#{prv.investigationItem.ixItemType eq 'DynamicLabel'}"
                                                               escape="false" />
                                            </h:panelGroup>
                                        </ui:repeat>
                                        <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >
                                            <h:panelGroup rendered="#{prv.investigationItem.retired eq false}"
                                                          layout="block" style="#{prv.investigationItem.cssStyle}; position:absolute;">
                                                <h:outputLabel value="#{prv.strValue}" rendered="#{prv.investigationItem.ixItemType eq 'Flag'}" escape="false" />
                                            </h:panelGroup>
                                        </ui:repeat>
                                        <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >
                                            <h:panelGroup rendered="#{prv.investigationItem.retired eq false}"
                                                          layout="block"  style="#{prv.investigationItem.cssStyle}; position:absolute;">
                                                <h:outputLabel
                                                    value="#{prv.doubleValue}"
                                                    style="z-index: 1000;"
                                                    rendered="#{prv.investigationItem.ixItemType eq 'Calculation' and prv.investigationItem.ixItemValueType eq 'Double'}"
                                                    escape="false" >
                                                    <f:convertNumber pattern="0.0" />
                                                </h:outputLabel>

                                                <h:outputLabel
                                                    value="#{prv.strValue}"
                                                    style="z-index: 1000;"
                                                    rendered="#{prv.investigationItem.ixItemType eq 'Calculation' and prv.investigationItem.ixItemValueType eq 'Varchar'}"
                                                    escape="false" >
                                                </h:outputLabel>
                                            </h:panelGroup>
                                        </ui:repeat>
                                        <ui:repeat value="#{patientReportController.currentPatientReport.item.reportItems}" var="myIi" >
                                            <h:panelGroup
                                                rendered="#{myIi.retired eq false}"
                                                layout="block"
                                                style="#{myIi.cssStyle}; position:absolute;">
                                                <h:outputText
                                                    rendered="#{myIi.retired ne true and myIi.ixItemType eq 'Label' }" value="#{myIi.htmltext}" style="color: #{myIi.cssColor}; z-index: 800; " escape="false" ></h:outputText>
                                            </h:panelGroup>
                                        </ui:repeat>
                                    </div>
                                </h:panelGroup>

                                <!--Microbiology-->
                                <h:panelGroup rendered="#{patientReportController.currentPatientReport.item.reportType eq 'Microbiology'}"  >
                                    <div id="divReportM"  class="labReport"   >
                                        <ez:common_report showBackground="#{patientReportController.showBackground}" commonReportFormat="#{patientReportController.currentPatientReport.reportFormat}"
                                                          patientReport="#{patientReportController.currentPatientReport}"/>
                                        <div style="position: absolute; top: #{configOptionApplicationController.getShortTextValueByKey('Microbiology Lab Report Height')}%; width: 97%; left: 1%; text-align: center; font-family:Cambria, Georgia, serif; font-size: 14px; height: 70%; vertical-align: top;" >
                                            <div id="ixName" >
                                                <h:outputLabel value="#{patientReportController.currentPatientReport.patientInvestigation.investigation.printName}"
                                                               style="font-weight: bold;font-size: 21px!important; "/>
                                            </div>
                                            <div id="labelsAndValues" style="left:5%; margin-top: 7px; width: 90%; display: inline-block; vertical-align: top; " >
                                                <div style="vertical-align: top; width: 100%; padding: 1px;margin: auto;display: inline-block;">
                                                    <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >
                                                        <h:panelGroup style="display: inline-block; clear: left; float: left; width: 100%; vertical-align: top; font-size: 15px;" layout="block"  rendered="#{prv.investigationItem.ixItemType eq 'Value' and prv.investigationItem.ixItemValueType eq 'Memo' and prv.investigationItem.retired ne true and prv.lobValue ne '' and prv.lobValue ne null and prv.investigationItem.riTop lt 50 }" >
                                                            <div style="display: inline-block; float: left; width: 1%; clear: left; " ></div>
                                                            <div style="display: inline-block; top: 0px; float: left; width: 30%; text-align: left; padding-top: 0.1%; padding-bottom: 0.1%; ">
                                                                <h:outputLabel value="#{prv.investigationItem.name}"   escape="false"/>
                                                            </div>
                                                            <div style="display: inline-block; float: left; width: 3%; " ></div>
                                                            <div style="display: inline-block; text-align: left; float:left; width: 60%; padding-top: 0.1%; padding-bottom: 0.1%; ">
                                                                <h:outputLabel value="#{fn:replace(prv.lobValue,'\\n','&lt;br/&gt;')}"   escape="false"   />
                                                            </div>
                                                        </h:panelGroup>
                                                    </ui:repeat>
                                                </div>

                                                <div style="vertical-align: top; text-align: left;  padding-top: 1%; padding-bottom: 0%; clear: left;">
                                                    <h:outputLabel value="Antibiotic Sensitivity Test"
                                                                   rendered="#{patientReportController.currentPatientReport.transHasAbst}"
                                                                   style="font-size: 135%; margin-top: 5px; font-weight: bold;"></h:outputLabel>
                                                </div>
                                                <h:outputLabel
                                                    value="#{patientInvestigationController.findAntibioticForMicrobiologyReport(patientReportController.currentPatientReport.patientReportItemValues)}"
                                                    style="display:none;"/>

                                                <div class="row">
                                                    <div class="col-6">
                                                        <ui:repeat
                                                            value="#{patientInvestigationController.column1AntibioticList}"
                                                            var="prv" >
                                                            <h:panelGroup
                                                                style="font-size: 15px;"
                                                                rendered="#{prv.investigationItem.ixItemType eq 'Antibiotic' and prv.investigationItem.retired ne true and prv.strValue ne '' and prv.strValue ne null  }" >
                                                                <div style="float: left;width: 5%; clear: left;" ></div>
                                                                <div style=" float: left; text-align: left; width: 70%; padding-left: 1px; padding-right: 1px; padding-top: 2px; vertical-align: top;">
                                                                    <h:outputLabel value="#{prv.investigationItem.name}"  escape="false" />
                                                                </div>
                                                                <div style="float: left;width: 2%;  " ></div>
                                                                <div style=" text-align: left; float:left;width: 30%;padding-left: 1px; padding-right: 1px; padding-top: 2px; vertical-align: top;">
                                                                    <h:outputLabel value="#{prv.strValue}" escape="false"
                                                                                   style="#{prv.strValue eq 'SENSITIVE' ? 'font-weight: bold;' : ''} text-transform: uppercase;" />
                                                                </div>

                                                            </h:panelGroup>
                                                        </ui:repeat>
                                                    </div>

                                                    <div class="col-6">
                                                        <ui:repeat
                                                            value="#{patientInvestigationController.column2AntibioticList}"
                                                            var="prv" >
                                                            <h:panelGroup
                                                                style="font-size: 16px;"
                                                                rendered="#{prv.investigationItem.ixItemType eq 'Antibiotic' and prv.investigationItem.retired ne true and prv.strValue ne '' and prv.strValue ne null  }" >
                                                                <div style="float: left;width: 5%; clear: left;" ></div>
                                                                <div style=" float: left; text-align: left; width: 70%; padding-left: 1px; padding-right: 1px; padding-top: 2px; vertical-align: top;">
                                                                    <h:outputLabel value="#{prv.investigationItem.name}"  escape="false" />
                                                                </div>
                                                                <div style="float: left;width: 2%;  " ></div>
                                                                <div style=" text-align: left; float:left;width: 30%;padding-left: 1px; padding-right: 1px; padding-top: 2px; vertical-align: top;">
                                                                    <h:outputLabel value="#{prv.strValue}" escape="false"
                                                                                   style="#{prv.strValue eq 'SENSITIVE' ? 'font-weight: bold;' : ''} text-transform: uppercase;" />
                                                                </div>

                                                            </h:panelGroup>
                                                        </ui:repeat>
                                                    </div>
                                                </div>

                                                <div style="vertical-align: top; text-align: left; padding-top: 3px; clear: left;">
                                                    <h:panelGroup rendered="#{patientReportController.currentPatientReport.patientReportItemValues.size()gt 0}">
                                                        <hr/>
                                                    </h:panelGroup>
                                                </div>

                                                <div style="vertical-align: top; text-align: left; font-size: 16px;  padding-top: 0%; padding-bottom: 0%; clear: left;">
                                                    <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >
                                                        <h:panelGroup rendered="#{prv.investigationItem.ixItemType eq 'Value' and prv.investigationItem.ixItemValueType eq 'Memo' and prv.investigationItem.retired ne true and prv.lobValue ne '' and prv.lobValue ne null and prv.investigationItem.riTop gt 50 }" >
                                                            <div style="float: left;width: 5%; " ></div>
                                                            <div style=" float: left; text-align: left; width: 20%;padding-left: 1px; padding-right: 1px; padding-top: 1px; vertical-align: top;">
                                                                <h:outputLabel value="#{prv.investigationItem.name}"  escape="false" />
                                                            </div>
                                                            <div style="float: left;width: 5%;  " ></div>
                                                            <div style=" text-align: left; float:left;width: 60%;padding-left: 1px; padding-right: 1px; padding-top: 1px; vertical-align: top;">
                                                                <h:outputLabel value="#{fn:replace(prv.lobValue,'\\n','&lt;br/&gt;')}"    escape="false" />
                                                            </div>
                                                        </h:panelGroup>
                                                    </ui:repeat>
                                                </div>

                                                <ui:repeat  value="#{patientReportController.currentPatientReport.patientReportItemValues}" var="prv" >
                                                    <div style="#{prv.investigationItem.cssStyle}; position:absolute;">
                                                        <p:graphicImage value="https://upload.wikimedia.org/wikipedia/en/e/e2/IMG_Academy_Logo.svg"
                                                                        style="width: #{prv.investigationItem.wtPix};overflow: visible; display: block;"
                                                                        height="#{prv.investigationItem.htPix}"

                                                                        width="#{prv.investigationItem.wtPix}">
                                                        </p:graphicImage>
                                                    </div>
                                                </ui:repeat>

                                            </div>
                                            <div style="clear: left;padding-top: 2%;">
                                                <h:outputLabel value="--- End of Report ---" style="font-size: 16px; font-weight: bold; "></h:outputLabel>
                                            </div>
                                        </div>
                                    </div>
                                </h:panelGroup>

                                <!--PathologyOrHaematology-->
                                <h:panelGroup rendered="#{patientReportController.currentPatientReport.item.reportType eq 'PathologyOrHaematology'}"  >
                                    <div id="divReportM"  class="labReport"   >
                                        <ez:common_report
                                            showBackground="#{patientReportController.showBackground}"
                                            commonReportFormat="#{patientReportController.currentPatientReport.reportFormat}"
                                            patientReport="#{patientReportController.currentPatientReport}">
                                        </ez:common_report>

                                        <div style="position: absolute; top: #{configOptionApplicationController.getShortTextValueByKey('Pathology or Haematology Lab Report Height')}%; width: 97%; font-family:Cambria, Georgia, serif; font-size: 14px; height: 70%; vertical-align: top;" >
                                            <div id="ixName" class="d-flex justify-content-center">
                                                <h:outputLabel
                                                    value="#{patientReportController.currentPatientReport.patientInvestigation.investigation.printName}"
                                                    style="font-weight: bold; font-size: 21px!important;">
                                                </h:outputLabel>
                                            </div>
                                            <div class="mt-3" style="font-size: 16px; margin-left:7%; margin-right: 5%; ">
                                                <h:outputLabel value="#{fn:replace(patientReportController.currentPatientReport.templateItem.lobValue,'\\n','&lt;br/&gt;')}" style="text-align: left;"  escape="false" />
                                            </div>

                                            <div style=" clear: left; padding-top: 2%; text-align: center;">
                                                <h:outputLabel value="--- End of Report ---" style="font-size: 16px; font-weight: bold; "></h:outputLabel>
                                            </div>
                                        </div>
                                    </div>
                                </h:panelGroup>

                            </h:panelGroup>
                        </div>
                    </div>
                </h:panelGroup>
            </ui:define>

        </ui:composition>

    </h:body>
</html>
