<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:cc="http://xmlns.jcp.org/jsf/composite"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui">

    <!-- INTERFACE -->
    <cc:interface>
    </cc:interface>

    <!-- IMPLEMENTATION -->
    <cc:implementation>
        <h:panelGroup rendered="#{patientInvestigationController.listingEntity eq 'PATIENT_SAMPLES_INDIVIDUAL'}" >
            <p:panel>
                <f:facet name="header">
                    <div class="d-flex justify-content-between">
                        <div class="d-flex gap-2">
                            <i class="fa fa-barcode mt-3" aria-hidden="true"></i>
                            <h:outputLabel value="Individual Barcode Sticker" class="mt-2"/>
                        </div>
                        <div class="d-flex gap-2">
                            <div class="d-flex gap-3">
                                <p:commandButton
                                    ajax="false" 
                                    class="ui-button-info"
                                    icon="fa fa-print"
                                    value="Print All">
                                    <p:printer target="batchBarcodeIndividual"></p:printer>
                                </p:commandButton>
                                <!--
                                                                                                                                              <h:outputLabel value="Print Individual Barcodes"/>
                                                                                                                                                <p:selectBooleanButton id="cheindbarIndividual" onIcon="pi pi-check" offIcon="pi pi-times" value="#{patientInvestigationController.printIndividualBarcodes}">
                                                                                                                                                    <p:ajax process="cheindbarIndividual" update="allBatchBarcodeIndividual individualBarcodeSingle batchBarcodeIndividual" event="change"></p:ajax>
                                                                                                                                                </p:selectBooleanButton>-->

                                <p:commandButton 
                                    icon="fa-solid fa-flask-vial"
                                    value="To Samples" 
                                    class="ui-button-warning"
                                    ajax="false"
                                    action="#{patientInvestigationController.navigateToThePatientSampleList()}" >
                                </p:commandButton>
                            </div>
                        </div>
                    </div>
                </f:facet>

                <h:panelGroup id="batchBarcodeIndividual">

                    <h:panelGroup id="allBatchBarcodeIndividual">
                        <ui:repeat value="#{patientInvestigationController.regeneratedPatientSamples}" var="ps">
                            <div class="sticker">
                                <div class="patient-info">
                                    <h:panelGroup rendered="#{configOptionApplicationController.getBooleanValueByKey('Print Sample ID PHN in Sample Stickers', true)}">
                                        <span class="sample-id">
                                            #{ps.idStr}&nbsp;&nbsp;
                                        </span>
                                    </h:panelGroup>
                                    <h:panelGroup rendered="#{configOptionApplicationController.getBooleanValueByKey('Print Patient Age in Sample Stickers')}">
                                        <span class="patient-age">
                                            #{ps.patient.person.ageAsShortString}&nbsp;&nbsp;
                                        </span>
                                    </h:panelGroup>
                                    <h:panelGroup rendered="#{configOptionApplicationController.getBooleanValueByKey('Print Patient Sex in Sample Stickers')}">
                                        <span class="patient-sex">
                                            #{ps.patient.person.sex.shortLabel}&nbsp;&nbsp;
                                        </span>
                                    </h:panelGroup>
                                    <h:panelGroup rendered="#{configOptionApplicationController.getBooleanValueByKey('Print Patient ID in Sample Stickers')}">
                                        <span class="patient-id">
                                            #{ps.patient.person.id}&nbsp;&nbsp;
                                        </span>
                                    </h:panelGroup>
                                    <h:panelGroup rendered="#{configOptionApplicationController.getBooleanValueByKey('Print Bill Type (IP/OP/CC) in Sample Stickers')}">
                                        <span class="patient-id">
                                            #{ps.bill.ipOpOrCc}&nbsp;&nbsp;
                                        </span>
                                    </h:panelGroup>
                                    <h:panelGroup rendered="#{configOptionApplicationController.getBooleanValueByKey('Print Barcode Generated Time in Sample Stickers')}">
                                        <span class="patient-id">
                                            <h:outputLabel value="#{ps.barcodeGeneratedAt}">
                                                <f:convertDateTime pattern="#{configOptionApplicationController.getShortTextValueByKey('Date Time Format for Barcode Generated Time in Sample Stickers','d/M/yy-hh:mm')}"></f:convertDateTime>
                                            </h:outputLabel>
                                            &nbsp;&nbsp;
                                        </span>
                                    </h:panelGroup>
                                    <h:panelGroup rendered="#{configOptionApplicationController.getBooleanValueByKey('Print Patient PHN in Sample Stickers')}">
                                        <span class="patient-phn">
                                            #{ps.patient.phn}
                                        </span>
                                    </h:panelGroup>
                                    <span class="patient-name">
                                        #{ps.patient.person.name}&nbsp;&nbsp;
                                    </span>
                                </div>
                                <div class="patient-sample-info">
                                    <ui:repeat value="#{patientInvestigationController.getPatientSampleComponentsByPatientSample(ps)}" var="psw">
                                        <span class="sample-component" style="font-weight: 800">
                                            #{psw.nameTranscient}&nbsp;&nbsp;
                                        </span>
                                    </ui:repeat>
                                </div>
                                <div class="barcode-info">
                                    <h:panelGroup rendered="#{configOptionApplicationController.getBooleanValueByKey('Print Barcode in Sample Stickers')}">
                                        <p:barcode 
                                            value="#{ps.idStr}" 
                                            cache="false"
                                            hrp="none"
                                            type="#{configOptionApplicationController.getShortTextValueByKey('Sample Sticker - Barcode Type','code128')}" 
                                            height="#{configOptionApplicationController.getShortTextValueByKey('Sample Sticker - Barcode Height in Pixles','80')}"
                                            width="#{configOptionApplicationController.getShortTextValueByKey('Sample Sticker - Barcode Width in Pixles','280')}"
                                            orientation="0"></p:barcode>
                                    </h:panelGroup>
                                </div>
                                <div class="patient-info">
                                    <h:panelGroup rendered="#{configOptionApplicationController.getBooleanValueByKey('Print Bill No in Sample Stickers', true)}">
                                        <span class="sample-id">
                                            #{ps.bill.deptId}&nbsp;&nbsp;
                                        </span>
                                    </h:panelGroup>
                                </div>
                            </div>
                        </ui:repeat>
                    </h:panelGroup>

                </h:panelGroup>

            </p:panel>

        </h:panelGroup>
    </cc:implementation>
</html>
