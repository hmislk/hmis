<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:cc="http://xmlns.jcp.org/jsf/composite"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui">

    <!-- INTERFACE -->
    <cc:interface>
        <cc:attribute name="deposits" type="java.util.List"
                      shortDescription="List of PatientDepositHistoryDto for deposits" />
        <cc:attribute name="transactions" type="java.util.List"
                      shortDescription="List of PatientDepositHistoryDto for all transactions" />
        <cc:attribute name="dateFormat" default="#{sessionController.applicationPreference.longDateFormat}" />
    </cc:interface>

    <!-- IMPLEMENTATION -->
    <cc:implementation>
        <div class="row my-2">
            <div class="col-6">
                <p:dataTable id="lateDp"
                             value="#{cc.attrs.deposits}"
                             var="lpd"
                             rowKey="#{lpd.id}"
                             emptyMessage="No deposits found">
                    <f:facet name="header">
                        <h:outputLabel value="Latest Deposits" />
                    </f:facet>
                    <p:column headerText="Date">
                        <h:outputLabel value="#{lpd.createdAt}">
                            <f:convertDateTime pattern="#{cc.attrs.dateFormat}" />
                        </h:outputLabel>
                    </p:column>
                    <p:column headerText="Payment">
                        <p:tag value="#{lpd.paymentMethodLabel}" severity="success"
                               rendered="#{lpd.paymentMethodLabel eq 'Cash'}" style="font-size: 0.8em" />
                        <p:tag value="#{lpd.paymentMethodLabel}" severity="danger"
                               rendered="#{lpd.paymentMethodLabel eq 'Card'}" style="font-size: 0.8em" />
                        <p:tag value="#{lpd.paymentMethodLabel}" severity="warning"
                               rendered="#{lpd.paymentMethodLabel ne 'Card' and lpd.paymentMethodLabel ne 'Cash'}"
                               style="font-size: 0.8em" />
                    </p:column>
                    <p:column headerText="Value">
                        <h:outputLabel value="#{lpd.transactionValue}">
                            <f:convertNumber pattern="#,###,##0.00" />
                        </h:outputLabel>
                    </p:column>
                </p:dataTable>
            </div>
            <div class="col-6">
                <p:dataTable id="lateTr"
                             value="#{cc.attrs.transactions}"
                             var="lpdh"
                             rowKey="#{lpdh.id}"
                             emptyMessage="No transactions found">
                    <f:facet name="header">
                        <h:outputLabel value="Latest Transactions" />
                    </f:facet>
                    <p:column headerText="Date">
                        <h:outputLabel value="#{lpdh.createdAt}">
                            <f:convertDateTime pattern="#{cc.attrs.dateFormat}" />
                        </h:outputLabel>
                    </p:column>
                    <p:column headerText="Bill ID">
                        <h:outputLabel value="#{lpdh.billDeptId}" />
                    </p:column>
                    <p:column headerText="Type">
                        <h:outputLabel value="#{lpdh.billTypeAtomicLabel}" />
                    </p:column>
                    <p:column headerText="Value">
                        <h:outputLabel value="#{lpdh.transactionValue}"
                                       rendered="#{lpdh.transactionValue gt 0}"
                                       style="color: green;">
                            <f:convertNumber pattern="#,###,##0.00" />
                        </h:outputLabel>
                        <h:outputLabel value="#{lpdh.transactionValue}"
                                       rendered="#{lpdh.transactionValue lt 0}"
                                       style="color: red;">
                            <f:convertNumber pattern="#,###,##0.00" />
                        </h:outputLabel>
                        <h:outputLabel value="#{lpdh.transactionValue}"
                                       rendered="#{lpdh.transactionValue eq 0}"
                                       style="color: black;">
                            <f:convertNumber pattern="#,###,##0.00" />
                        </h:outputLabel>
                    </p:column>
                </p:dataTable>
            </div>
        </div>
    </cc:implementation>
</html>
