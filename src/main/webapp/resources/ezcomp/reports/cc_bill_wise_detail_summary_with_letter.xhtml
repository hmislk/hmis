<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:cc="http://xmlns.jcp.org/jsf/composite"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <cc:interface>
    </cc:interface>

    <h:head>
    </h:head>

    <h:body>

        <!-- Composite Component Implementation -->
        <cc:implementation>
            <style>

                @media screen{
                    .paper{
                        position: static !important;
                        width: 297mm!important;
                        zoom: 1.6;
                    }

                    table {
                        border-collapse: collapse;
                        width: 100%;
                        font-size: 12px!important;
                        margin-top: 1mm!important;
                    }

                    th, td {
                        border: 1px solid #000;
                        padding: 0px!important;
                        margin: 2px!important;
                        text-align: left;
                        margin-left: 10mm!important;
                    }

                    .header{
                        font-size: 18px!important;
                        font-weight: 700!important;
                        text-align: center!important;
                        text-decoration: underline!important;
                    }

                    .data{
                        font-size: 12px!important;
                        line-height: 1.2;
                    }

                    tfoot{
                        font-weight: 700!important;
                        font-size: 11px!important;
                    }
                }

                @media print {
                    @page {
                        @bottom-right {
                            content: "Page " counter(page) " of " counter(pages);
                            font-family: Arial, sans-serif;
                            font-size: 10pt;
                        }
                    }

                    body {
                        counter-reset: page;
                    }

                    .paper{
                        position: static !important;
                        width: 297mm!important;
                        size: A4 portrait!important;

                    }

                    .header{
                        line-height: 1.1;
                        margin: 0mm!important;
                        font-size: 16px!important;
                        font-weight: 700!important;
                        text-decoration: underline!important;
                        text-align: center!important;
                    }

                    .data{
                        font-size: 12px!important;
                        line-height: 1.1;
                    }

                    table {
                        border-collapse: collapse;
                        width: 99.9%;
                        font-size: 11px!important;
                        margin-top: 1mm!important;
                    }
                    th, td {
                        border: 1px solid #000;
                        padding: 0px!important;
                        margin: 2px!important;
                        text-align: left;
                        margin-left: 10mm!important;
                    }
                    th {

                    }
                    tfoot{
                        font-weight: 700!important;
                        font-size: 11px!important;
                    }
                }
            </style>

            <h:panelGroup id="reportView" class="d-flex justify-content-center">
                <div class="paper">
                    <div class="d-grid data">
                        <h:outputLabel value="#{reportsController.currentDate}" style="text-align: left; display: block;">
                            <f:convertDateTime pattern="#{sessionController.applicationPreference.longDateFormat}"/>
                        </h:outputLabel>
                        <h:outputText value="#{reportsController.collectingCentre.name}," style="text-align: left; display: block;"/>
                        <h:outputText value="#{reportsController.collectingCentre.address}." style="text-align: left; display: block;"/>
                        <br/>
                        <h:outputText value="Dear Sir/Madam," style="text-align: left; display: block;"/>
                    </div>

                    <div class="header" >
                        <h:outputText value="SETTLEMENT OF INVESTIGATION BILL"/>
                    </div>

                    <div class="d-flex data mb-2">
                        <h:outputText value="Period : " style="width: 4em!important;"/>
                        <h:outputText value="#{reportsController.fromDate}">
                            <f:convertDateTime pattern="#{sessionController.applicationPreference.longDateFormat}" />
                        </h:outputText>
                        <h:outputText value="to" style="width: 2em!important; text-align: center;"/>
                        <h:outputText value="#{reportsController.toDate}">
                            <f:convertDateTime pattern="#{sessionController.applicationPreference.longDateFormat}" />
                        </h:outputText>
                    </div>

                    <div>
                        <table>
                            <thead>
                                <tr>
                                    <th style="width: 10mm; font-weight: 700;">
                                        <h:outputText value="S.No" style="margin-left: 1mm;"/>
                                    </th>
                                    <th style="width: 50mm;font-weight: 700;">
                                        <h:outputText value="Bill No (Invoice No)" style="margin-left: 1mm;"/>
                                    </th>
                                    <th style="width: 30mm; font-weight: 700; text-align: left;">
                                        <h:outputText value="Ref. No (Leaf No)" style="margin-left:  1mm;"/>
                                    </th>
                                    <th style="width: 40mm; font-weight: 700; text-align: left;">
                                        <h:outputText value="Bill Date" style="margin-left:  1mm;"/>
                                    </th>
                                    <th style="width: 85mm; font-weight: 700;">
                                        <h:outputText value="Patient Name" style="margin-left: 1mm;"/>
                                    </th>
                                    <th style="width: 25mm; font-weight: 700; text-align: right;">
                                        <h:outputText value="Hospital Fee" style="margin-right: 1mm;"/>
                                    </th>
                                    <th style="width: 25mm; font-weight: 700; text-align: right;">
                                        <h:outputText value="Professional Fee" style="margin-right: 1mm;"/>
                                    </th>
                                    <th style="width: 25mm; font-weight: 700; text-align: right;">
                                        <h:outputText value="Net Amount" style="margin-right: 1mm;"/>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <ui:repeat value="#{reportsController.bundle.reportTemplateRows}" var="row" varStatus="i">
                                    <tr>
                                        <td style="width: 10mm;" >
                                            <h:outputText value="#{i.index +1}" style="margin-left: 1mm;"/>
                                        </td>
                                        <td style="width: 50mm; text-align: left;">
                                            <h:outputText value="#{row.billItem.bill.deptId}" style="margin-left: 1mm;"/>
                                        </td>
                                        <td style="width: 30mm; text-align: left;">
                                            <h:outputText value="#{row.billItem.bill.billTypeAtomic eq 'CC_BILL_CANCELLATION' ? row.billItem.bill.billedBill.referenceNumber: row.billItem.bill.referenceNumber}" style="margin-left: 1mm;"></h:outputText>
                                        </td>
                                        <td style="width: 40mm; text-align: left;">
                                            <h:outputText value="#{row.billItem.bill.createdAt}" style="margin-left: 1mm;">
                                                <f:convertDateTime pattern="dd MM yyyy hh:mm a" />
                                            </h:outputText>
                                        </td>
                                        <td style="width: 85mm;">
                                            <h:outputText value="#{row.billItem.bill.patient.person.name}" style="margin-left: 1mm;"></h:outputText>
                                        </td>
                                        <td style="width: 25mm; text-align: right;">
                                            <h:outputText value="#{row.billItem.hospitalFee}" style="margin-right: 1mm;">
                                                <f:convertNumber pattern="#,##0.00" />
                                            </h:outputText>
                                        </td>
                                        <td style="width: 25mm; text-align: right;">
                                            <h:outputText value="#{row.billItem.staffFee}" style="margin-right: 1mm;">
                                                <f:convertNumber pattern="#,##0.00" />
                                            </h:outputText>
                                        </td>
                                        <td style="width: 25mm; text-align: right;">
                                            <h:outputText value="-#{row.billItem.netValue}" style="margin-right: 1mm;"></h:outputText>
                                        </td>
                                    </tr>
                                </ui:repeat>
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td style="width: 10mm;" ></td>
                                    <td style="width: 50mm; text-align: left;"></td>
                                    <td style="width: 30mm; text-align: left;"></td>
                                    <td style="width: 40mm; text-align: left;"></td>
                                    <td style="width: 85mm; text-align: right;"></td>
                                    <td style="width: 25mm; text-align: right;">
                                        <h:outputText value="#{reportsController.bundle.hospitalTotal}" style="margin-right: 1mm;">
                                            <f:convertNumber pattern="#,##0.00" />
                                        </h:outputText>
                                    </td>
                                    <td style="width: 25mm; text-align: right;">
                                        <h:outputText value="#{reportsController.bundle.staffTotal}" style="margin-right: 1mm;">
                                            <f:convertNumber pattern="#,##0.00" />
                                        </h:outputText>
                                    </td>
                                    <td style="width: 25mm; text-align: right;">
                                        <h:outputText value="#{reportsController.bundle.total}" style="margin-right: 1mm;">
                                            <f:convertNumber pattern="#,##0.00" />
                                        </h:outputText>
                                    </td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>

                    <div id="report-end">
                        <div>
                            <h:outputLabel
                                class="data mt-2"
                                value="#{configOptionApplicationController.getLongTextValueByKey('Footer Text for Collection Centre Bill Wise Detail Report - Summary With Letter')}" 
                                escape="false" >
                            </h:outputLabel>
                            <h:panelGroup 
                                rendered="#{configOptionApplicationController.getLongTextValueByKey('Footer Text for Collection Centre Bill Wise Detail Report Contact - Summary With Letter').length() ne 0.0}" 
                                class="d-flex gap-2">
                                <h:outputLabel
                                    class="data"
                                    value="#{configOptionApplicationController.getLongTextValueByKey('Footer Text for Collection Centre Bill Wise Detail Report Contact - Summary With Letter')}" 
                                    escape="false" >
                                </h:outputLabel>
                                <h:outputLabel
                                    class="data"
                                    style="font-weight: 700;"
                                    value="#{sessionController.loggedUser.webUserPerson.nameWithTitle}"  >
                                </h:outputLabel>
                                <h:outputLabel
                                    class="data"
                                    value=" (Tel : #{sessionController.loggedUser.webUserPerson.mobile})">
                                </h:outputLabel>
                            </h:panelGroup>
                        </div>

                        <h:outputLabel
                            class="data"
                            value="#{configOptionApplicationController.getLongTextValueByKey('Footer Text for Collection Centre Bill Wise Detail Report Address - Summary With Letter')}" 
                            escape="false" >
                        </h:outputLabel>

                        <div class="data mt-2">
                            <h:outputLabel 
                                value="#{reportsController.currentDate}"
                                style="text-align: right; display: block;">
                                <f:convertDateTime
                                    pattern="#{sessionController.applicationPreference.longDateTimeFormat}"/>
                            </h:outputLabel>
                        </div>

                    </div>

                </div>
            </h:panelGroup>
        </cc:implementation>

    </h:body>
</html>


