<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns:cc="http://xmlns.jcp.org/jsf/composite"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:p="http://primefaces.org/ui"
       xmlns:f="http://xmlns.jcp.org/jsf/core">

    <!-- INTERFACE -->
    <cc:interface>
        <cc:attribute name="bill" type="com.divudi.entity.Bill"/>
        <cc:attribute name="billController" type="com.divudi.bean.pharmacy.DealorPaymentBillSearch" />
        <cc:attribute name="dup" type="java.lang.Boolean" />
    </cc:interface>

    <!-- IMPLEMENTATION -->
    <cc:implementation>

        <div >
            <div >
                <div >

                    <h:outputStylesheet name="printing.css" library="css" />
                    <div class="d-flex justify-content-end">
                        <p:commandButton 
                            style="width: 100px" 
                            value="Print" 
                            ajax="false" 
                            action="#"  
                            class="ui-button-info mb-2"
                            icon="fa fa-print">
                            <p:printer target="gpBillPreview" ></p:printer>
                        </p:commandButton>
                    </div>



                    <!--                    <div class="fiveinchbillBreakRuhunu" >
                    
                                            <p:panel   id="gpBillPreview" style="border: none;"  >
                    
                    
                                                <div style="position: absolute!important;left: 45%!important; font-weight: bold!important;
                                                     top: 0%!important;font-size: 15px!important; text-decoration: underline!important;">
                                                    <h:outputLabel value="Receipt"   />                           
                                                </div>
                    
                                                <div style="position: absolute;
                                                     left: 0%!important;
                                                     top: 7%!important;
                                                     font-size: 12px!important;">
                                                    <h:outputLabel value="Receipt No"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 23%;
                                                     top: 7%;
                                                     font-size:12px!important;">
                                                    <h:outputLabel value=":"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 25%!important;
                                                     top: 7%!important;
                                                     font-size: 12px!important;">                                                 
                                                    <h:outputLabel value="#{cc.attrs.bill.cancelledBill.deptId} **Cancelled"  
                                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId ne null}"/> 
                                                    <h:outputLabel value="#{cc.attrs.bill.refundedBill.deptId} **Returned"  
                                                                   rendered="#{cc.attrs.bill.refundedBill.deptId ne null}"/> 
                                                    <h:outputLabel value="#{cc.attrs.bill.deptId}" 
                                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId eq null and cc.attrs.bill.refundedBill.deptId eq null}"/>  
                                                    <h:outputLabel value="  **Duplicate" 
                                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId eq null and cc.attrs.dup eq true }" />
                                                </div>
                    
                                                <div style="position: absolute;
                                                     left: 73%!important;
                                                     top: 7%!important;
                                                     font-size: 12px!important;">
                                                    <h:outputLabel value="Date"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 82%;
                                                     top: 7%;
                                                     font-size:12px!important;">
                                                    <h:outputLabel value=":"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 84%!important;
                                                     top: 7%!important;
                                                     font-size: 12px!important;" >                  
                                                    <h:outputLabel value="#{cc.attrs.bill.cancelledBill.billDate}"
                                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId ne null}"  >
                                                        <f:convertDateTime pattern="#{sessionController.applicationPreference.shortDateFormat}"/>
                                                    </h:outputLabel>  
                                                    <h:outputLabel value="#{cc.attrs.bill.refundedBill.billDate}"
                                                                   rendered="#{cc.attrs.bill.refundedBill.deptId ne null}"  >
                                                        <f:convertDateTime pattern="#{sessionController.applicationPreference.shortDateFormat}"/>
                                                    </h:outputLabel>
                                                    <h:outputLabel value="#{cc.attrs.bill.createdAt}"
                                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId eq null and cc.attrs.bill.refundedBill.deptId eq null}">
                                                        <f:convertDateTime pattern="#{sessionController.applicationPreference.shortDateFormat}"/>
                                                    </h:outputLabel>
                                                </div>
                    
                                                <div style="position: absolute;
                                                     left: 0%!important;
                                                     top: 11%!important;
                                                     font-size: 12px!important;">
                                                    <h:outputLabel value="Payment Type"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 23%;
                                                     top: 11%;
                                                     font-size:12px!important;">
                                                    <h:outputLabel value=":"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 25%;
                                                     top: 11%;
                                                     font-size:12px!important;" >                    
                                                    <h:outputLabel value="#{cc.attrs.bill.cancelledBill.paymentMethod}" 
                                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId ne null}" />                        
                                                    <h:outputLabel value="#{cc.attrs.bill.paymentMethod}" 
                                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId eq null }"/>
                                                </div>
                    
                                                <div style="position: absolute;
                                                     left: 73%!important;
                                                     top: 11%!important;
                                                     font-size: 12px!important;">
                                                    <h:outputLabel value="Time"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 82%;
                                                     top: 11%;
                                                     font-size:12px!important;">
                                                    <h:outputLabel value=":"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 84%;
                                                     top: 11%;
                                                     font-size:12px!important;" >                                                 
                                                    <h:outputLabel value="#{cc.attrs.bill.cancelledBill.billTime}"  
                                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId ne null}">
                                                        <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.shortTimeFormat}" />
                                                    </h:outputLabel>                        
                                                    <h:outputLabel value="#{cc.attrs.bill.billTime}" 
                                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId eq null }">
                                                        <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.shortTimeFormat}" />
                                                    </h:outputLabel>
                                                </div>
                    
                                                <div style="position: absolute;
                                                     left: 0%!important;
                                                     top: 15%!important;
                                                     font-size: 12px!important;">
                                                    <h:outputLabel value="Company"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 23%;
                                                     top: 15%;
                                                     font-size:12px!important;">
                                                    <h:outputLabel value=":"/>
                                                </div>
                                                <div style="position: absolute;
                                                     left: 25%;
                                                     top: 15%;
                                                     font-size:15px!important;" >                    
                                                    <p:outputLabel value="#{cc.attrs.bill.fromInstitution.name}" />
                                                </div>
                    
                                                <div style="position: absolute;
                                                     left: 0%!important;
                                                     top: 19%!important;
                                                     font-size: 12px!important;">
                                                    <h:outputLabel value="OPD Credit Settlement" rendered="#{cc.attrs.billController.billItems.get(0).patientEncounter eq null}"/>
                                                    <h:outputLabel value="BHT Credit Settlement" rende`d="#{cc.attrs.billController.billItems.get(0).patientEncounter ne null}"/>
                                                </div>
                    
                                                <h:outputLabel value="#{cc.attrs.bill.patient.person.nameWithTitle}"
                                                               rendered="#{cc.attrs.bill.patient ne null}"
                                                               style=" position: absolute;left: 25%;top: 35%;font-weight: bold;">
                                                </h:outputLabel>
                    
                                                <h:outputLabel value="#{cc.attrs.bill.patient.person.phone}"
                                                               rendered="#{cc.attrs.bill.patient ne null}"
                                                               styleClass="phonePrinting" >
                                                </h:outputLabel>
                    
                                                <h:outputLabel value="#{cc.attrs.bill.collectingCentre.name} #{cc.attrs.bill.creditCompany.name}"
                                                               styleClass="billNamePrinting"  >
                                                </h:outputLabel>
                    
                                                <div style="font-size: 11px;
                                                     position: absolute;
                                                     left: 10%;
                                                     top: 25%;" >
                                                    <h:dataTable value="#{cc.attrs.bill.billItems}" var="b" >                                               
                                                        <p:column >                                                     
                                                            <p:outputLabel style="font-size: 10px!important" value="#{b.patientEncounter.bhtNo} - " rendered="#{b.patientEncounter ne null}"/>
                                                            <p:outputLabel style="font-size: 10px!important" value="#{b.referenceBill.deptId}" rendered="#{b.patientEncounter eq null}"/>
                                                        </p:column>
                                                        <p:column headerText="Patient Name">
                                                            <p:outputLabel style="font-size: 10px!important" value="#{b.referenceBill.patient.person.name}" rendered="#{b.patientEncounter eq null}"/>
                                                            <p:outputLabel style="font-size: 10px!important" value="#{b.patientEncounter.patient.person.name}" rendered="#{b.patientEncounter ne null}"/>
                                                        </p:column>                                              
                                                    </h:dataTable>
                                                    <p:spacer height="5px;"></p:spacer>
                                                    <table style="min-width:100%;">
                                                        <tr>
                                                            <td style="min-width: 3.5cm;text-align: left;">
                                                                <h:outputLabel value="TOTAL"/>
                                                            </td>
                                                            <td>
                                                                <h:outputLabel value="#{cc.attrs.bill.netTotal}"  style="font-size: 110%; font-weight: bold ; text-align: right">
                                                                    <f:convertNumber pattern="#,##0.00" />
                                                                </h:outputLabel>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                    <p:spacer height="25px;"></p:spacer>
                                                    <table style="min-width:100%;">
                                                        <tr>
                                                            <td style="min-width: 3cm; text-decoration: overline;">
                                                                <p:outputLabel value="Cashier ID : #{cc.attrs.bill.creater.id}" style="font-size: 11px!important;"/>
                                                            </td>
                                                            <td style="min-width: 5cm;text-decoration: overline;width: 75%!important;" >
                                                                <p:outputLabel value=""  style="font-size: 11px!important;"/>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                    
                                                <div style="font-size: 11px;
                                                     position: absolute;
                                                     left: 80%;
                                                     top: 25%;" >
                                                    <h:dataTable value="#{cc.attrs.bill.billItems}" var="bip1" >
                                                        <h:column>
                                                            <h:outputLabel value="#{bip1.netValue}"  style="font-size: 10px!important; float: right;" >
                                                                <f:convertNumber pattern="#,##0.00" />
                                                            </h:outputLabel>
                                                        </h:column>
                                                    </h:dataTable>
                    
                                                </div>
                    
                                            </p:panel>
                                        </div>-->



                    <cc:implementation>
                        <h:outputStylesheet library="css" name="pharmacyA4.css"/>
                        <div class="posbill noBorder summeryBorder" >

                            <div class="institutionName">
                                <h:outputLabel value="#{cc.attrs.bill.creater.department.printingName}"/>
                            </div>
                            <div class="institutionName">
                                <h:outputLabel value="#{cc.attrs.bill.department.name}"/>
                            </div>

                            <div >

                                <h4 style="color: #000000; text-align: center " >
                                    <h:outputLabel value="Payment Voucher" style="text-decoration: underline;"/>
                                </h4>
                                
                                <div class="institutionName">                                                 
                                    <p:outputLabel value="#{cc.attrs.bill.cancelledBill.deptId} **Cancelled"  
                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId ne null}"/> 
                                    <p:outputLabel value="#{cc.attrs.bill.refundedBill.deptId} **Returned"  
                                                   rendered="#{cc.attrs.bill.refundedBill.deptId ne null}"/> 
                                    <p:outputLabel value="#{cc.attrs.bill.deptId}" 
                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId eq null and cc.attrs.bill.refundedBill.deptId eq null}"/>  
                                    <p:outputLabel value="  **Duplicate" 
                                                   rendered="#{cc.attrs.bill.cancelledBill.deptId eq null and cc.attrs.dup eq true }" />
                                </div>


                                <div>
                                    <h:outputLabel value="Payee : " style="text-align: right!important;"/>
                                    <h:outputLabel value="#{cc.attrs.bill.toInstitution.name}"/>
                                    <h:outputLabel value="Date :"  style="position: relative; left: 70%;" />
                                    <h:outputLabel value="#{cc.attrs.bill.createdAt}"  style="position: relative; left: 70%;" >
                                        <f:convertDateTime pattern="dd MM yyyy hh mm a"/>
                                    </h:outputLabel>

                                </div>

                                <div>

                                    <p:dataTable value="#{cc.attrs.billItems}" var="bi" sortBy="#{bi.referenceBill.invoiceNumber}">

                                        <p:column headerText="Po Approve">
                                            <p:outputLabel value="#{bi.referenceBill.referenceBill.createdAt}" style="text-align: center;">
                                                <f:convertDateTime pattern="dd/mm/yyyy hh:mm a"/>                                
                                            </p:outputLabel>
                                        </p:column>                   


                                        <p:column headerText="Grn Date">
                                            <p:outputLabel value="#{bi.referenceBill.createdAt}" style="text-align: center;">
                                                <f:convertDateTime pattern="dd/mm/yyyy hh:mm a"/>

                                            </p:outputLabel>
                                        </p:column>

                                        <p:column headerText="Grn Number" >
                                            <p:outputLabel value="#{bi.referenceBill.deptId}" style="text-align: center;"/>
                                        </p:column>



                                        <p:column headerText="Invoice Number" >
                                            <p:outputLabel value="#{bi.referenceBill.invoiceNumber}" style="text-align: center;"/>
                                        </p:column>

                                        <p:column headerText="Amount">
                                            <p:outputLabel value="#{0-bi.referenceBill.netTotal}" style="text-align: right;">
                                                <f:convertNumber pattern="#,##0.00" />
                                            </p:outputLabel>
                                        </p:column>

                                    </p:dataTable>

                                </div>

                                <div>

                                    <h3>Bill Details</h3>
                                    <h:panelGroup class="col-10 ">
                                        <p:outputLabel value="Payee:" style="font-weight: bold;" />
                                        <p:outputLabel value="#{cc.attrs.bill.toInstitution.name}" />
                                        <br/>

                                        <p:outputLabel value="Bank:" style="font-weight: bold;"/>
                                        <p:outputLabel value="#{cc.attrs.bill.bank.name}"/>
                                        <br/>

                                        <p:outputLabel value="Cheque Date:" style="font-weight: bold;"/>
                                        <p:outputLabel  value="#{cc.attrs.bill.chequeDate}" >
                                            <f:convertDateTime pattern="#{sessionController.applicationPreference.longDateTimeFormat}"/>
                                        </p:outputLabel>
                                        <br/>

                                        <p:outputLabel value="Cheque NO:" style="font-weight: bold;"/>
                                        <p:outputLabel value="#{cc.attrs.bill.chequeRefNo}" />
                                        <br/>

                                        <p:outputLabel value="Amount:" style="font-weight: bold;"/>
                                        <p:outputLabel value="#{0 - cc.attrs.bill.netTotal}">
                                            <f:convertNumber pattern="#,##0.00" />
                                        </p:outputLabel>
                                        <br/>
                                    </h:panelGroup>

                                </div>


                                <div>
                                    <br></br>
                                    <h:outputLabel value="Prepared By :" /> 
                                    <h:outputLabel value="#{cc.attrs.bill.creater.webUserPerson.nameWithTitle}" style="text-align: right!important;text-decoration: underline; text-decoration-style: dotted;"/>
                                    <br></br>                
                                    <br></br>         
                                    <h:outputLabel value="Approved By :"/>
                                    <h:outputLabel value="#{cc.attrs.bill.referenceBill.creater.webUserPerson.nameWithTitle}"/>
                                    <br></br>                                      
                                    <br></br>
                                    <h:outputLabel value="Authorized By :"/>
                                    <h:outputLabel value="................................................................"/>
                                    <br></br>
                                    <br></br>

                                    <h:outputLabel value="Cheque No :"/>
                                    <h:outputLabel value="...................................................................."/>
                                    <h:outputLabel value="Amount : Rs. #{0-cc.attrs.bill.netTotal} " style="position: absolute; left: 70%;"/>
                                    <br></br>
                                    <br></br>                    
                                    <h:outputLabel value="Received with thanks sum of Rupees  .................................................................................................................................................. #{sessionController.loggedUser.institution.name} "/>
                                    <br></br>

                                    <!--                    <div >-->

                                    <!--<h:outputLabel value="Date :"  style="position: relative; left: 70%;" />-->
                                    <!--                        <br/>-->
                                    <!--                        <h:outputLabel value="Amount : Rs. " style="font-weight: bold;position: relative; left: 70%;"/>-->
                                    <!--                        <h:outputLabel value="#{0-cc.attrs.bill.netTotal}" style="font-weight: bold;position: relative; left: 71%;">-->
                                    <!--<f:convertNumber pattern="#,##0.00" />-->
                                    <!--                        </h:outputLabel>-->
                                    <!--                        <br/>-->
                                    <div>
                                        <h:outputLabel value="Stamp : " style="position: relative; left: 70%; "/>
                                        <div style="position: relative; border: 1px black dashed!important;height: 60px;width: 50px; left: 75%;">
                                        </div>
                                        <!--                        <h:outputLabel value="Stamp " style="position: relative; left: 70%;"/>-->
                                        <!--                        <br></br>-->
                                        <h:outputLabel value="Date : " style="position: relative; left: 70%;"/>
                                        <br></br>
                                        <h:outputLabel value="Name : " style="position: relative; left: 70%;"/>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </cc:implementation>
                </div>
            </div>
        </div>


    </cc:implementation>
</html>