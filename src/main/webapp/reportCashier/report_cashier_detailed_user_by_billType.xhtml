<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      >

    <h:body>

        <ui:composition template="/reportCashier/report_cashier.xhtml">

            <ui:define name="subcontent">



                <h:form>

                    <p:panel header="Summary By Bill Type">

                            <h:panelGrid columns="2" class="my-2" >
                                <h:outputLabel value="From"/>
                                <p:calendar id="frmDate" value="#{commonReport.fromDate}" navigator="true"  pattern="#{sessionController.applicationPreference.longDateTimeFormat}"  class="w-100 mx-4" inputStyleClass="w-100">
                                </p:calendar>

                                <h:outputLabel value="To"/>
                                <p:calendar id="toDate" value="#{commonReport.toDate}" navigator="true" pattern="#{sessionController.applicationPreference.longDateTimeFormat}"  class="w-100 mx-4" inputStyleClass="w-100">
                                </p:calendar>

                                <h:outputLabel value="Billed Department"/>
                                <p:autoComplete id="frmdep" completeMethod="#{departmentController.completeDept}" 
                                                var="dept" itemLabel="#{dept.name}" itemValue="#{dept}" 
                                                forceSelection="true" 
                                                value="#{commonReport.fromDepartment}" class="w-100 mx-4" inputStyleClass="w-100"/>

                                <h:outputLabel value="For Department"/>
                                <p:autoComplete id="todep" completeMethod="#{departmentController.completeDept}" 
                                                var="tdept" itemLabel="#{tdept.name}" itemValue="#{tdept}" 
                                                forceSelection="true" 
                                                value="#{commonReport.toDepartment}" class="w-100 mx-4" inputStyleClass="w-100"/>


                                <h:outputLabel value="Select Bill Type" for="cmdBillType"/>
                                <p:selectOneMenu id="cmdBillType" value="#{commonReport.billType}" class="w-100 mx-4"
                                                 required="true" 
                                                 requiredMessage="Please select a bill type">
                                    <f:selectItem itemLabel="Select Bill Type"/>
                                    <f:selectItems value="#{enumController.cashFlowBillTypes}" var="i" itemLabel="#{i.label}" itemValue="#{i}" class="w-100 mx-4" />
                                </p:selectOneMenu>
                            </h:panelGrid>

                            <h:panelGrid columns="6" class="my-2" >
                                <p:commandButton  id="btnRefresh" ajax="false" value="Process" 
                                                  class="ui-button-warning" icon="fas fa-cogs"
                                                  actionListener="#{commonReport.fillBillTypeBills()}" />  
                                <p:commandButton ajax="false" value="Print"
                                                 class="ui-button-info mx-2" icon="fas fa-print"
                                                 >
                                    <p:printer target="reportPrint"/>
                                </p:commandButton>  
                                <p:commandButton ajax="false"  
                                                 class="ui-button-success" icon="fas fa-file-excel"
                                                 value="Excel" >
                                    <p:dataExporter type="xlsx" 
                                                 target="#{commonReport.billType}billed,
                                                 #{commonReport.billType}cancelled,
                                                 #{commonReport.billType}refunded,
                                                 sum"  
                                                 fileName="Day_END_By_Bill_Type" />


                                </p:commandButton>
                            </h:panelGrid>








                        <p:panel  id="reportPrint" styleClass="noBorder">
                            <h:panelGroup rendered="#{commonReport.billType eq 'OpdBill'}" >  

                                <p:dataTable id="OpdBillbilled"  value="#{commonReport.billedBills.bills}" var="b" 
                                             sortBy="#{b.billType}"  >

                                    <f:facet name="header">  

                                        <h:outputLabel value="#{commonReport.webUser.webUserPerson.name} " style="float: left"/>
                                        <h:outputLabel value="Summary By Bill Type"/><br/> 
                                        <h:outputLabel value="From : &emsp;"/>
                                        <h:outputLabel value="#{searchController.fromDate}">
                                            <f:convertDateTime pattern="dd MMM yyyy hh:mm:ss a"/>
                                        </h:outputLabel><p:spacer width="30" height="1"/>
                                        <h:outputLabel value="&emsp;To :&emsp; "/>
                                        <h:outputLabel value="#{searchController.toDate}">
                                            <f:convertDateTime pattern="dd MMM yyyy hh:mm:ss a"/>
                                        </h:outputLabel>
                                        <h:outputLabel value="Bill Type : #{commonReport.billType} &emsp;" style="float: left"/>
                                    </f:facet>

                                    <p:column headerText="Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.insId}"/>
                                        <!--<h:outputLabel value="#{b.paymentMethod}"/>-->
                                    </p:column>

                                    <p:column headerText="Time"  > 
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.createdAt}" >
                                            <f:convertDateTime pattern="h:mm a"/>
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.creater.webUserPerson.name}"/>

                                    </p:column>


                                    <p:column headerText="From Department" 
                                              rendered="#{commonReport.fromDepartment eq null}" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="From Department"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.fromDepartment.name}"/>

                                    </p:column>


                                    <p:column headerText="To Department" rendered="#{commonReport.toDepartment eq null}" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="To Department"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.toDepartment.name}"/>

                                    </p:column>

                                    <p:column headerText="Patient Name" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Patient Name"/>
                                        </f:facet> 
                                        <h:outputLabel value=" #{b.patient.person.nameWithTitle}"/>               
                                    </p:column>

                                    <p:column headerText="Dis." styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Dis."/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.discount}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cash'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cash'}" value="0.00" />
                                    </p:column>

                                    <p:column headerText="Credit" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Credit"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Credit'}" value="#{b.netTotal}"  >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Credit'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="C Card" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="C Card"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Card'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Card'}" value="0.00">
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Checque" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cheque'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Slip" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Slip'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Remark" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Remark"/>
                                        </f:facet> 
                                        <h:outputLabel value="Cancelled. (#{b.cancelledBill.insId})" rendered="#{b.cancelled==true}" ></h:outputLabel>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="6" style="text-align:left" footerText="Totals:"/>  

                                            <p:column footerText="#{commonReport.billedBills.cash}">
                                                <f:facet name="footer">
                                                    Rs. 
                                                    <h:outputLabel value="#{commonReport.billedBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.credit}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.credit}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.card}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.card}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.slip}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>
                                        </p:row>  
                                    </p:columnGroup>  

                                </p:dataTable>

                                <p:spacer height="30"/>

                                <p:dataTable id="OpdBillcancelled"  value="#{commonReport.cancellededBills.bills}" var="b1" >
                                    <f:facet name="header">  
                                        <h:outputLabel value="Cancelled"/>
                                    </f:facet> 

                                    <p:column headerText="Time">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.createdAt}" >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.creater.webUserPerson.name}"/>
                                    </p:column>

                                    <p:column headerText="Cancelled Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cancelled ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.insId}"/>
                                    </p:column>

                                    <p:column headerText="Billed Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.billedBill.insId}" >
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Patient Name" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Patient Name"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.patient.person.nameWithTitle}"/>

                                    </p:column>
                                    <p:column headerText="Comment" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Comment"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.comments}"/>
                                    </p:column>

                                    <p:column headerText="Cash"  styleClass="averageNumericColumn"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Cash'}" value="#{b1.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Credit"  styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Credit"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Credit'}" value="#{b1.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Credit'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="C Card"  styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="C Card"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Card'}" value="#{b1.netTotal}"  >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Card'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Checque" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Cheque'}" value="#{b1.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Slip" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Slip'}" value="#{b1.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column>
                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  

                                        <p:row>  
                                            <p:column colspan="6" style="text-align:left" footerText="Totals:">
                                            </p:column>

                                            <p:column footerText="#{commonReport.institutionCancelledBillsOwn.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionCancelledBillsOwn.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>      

                                            <p:column footerText="#{commonReport.institutionCancelledBillsOwn.credit}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionCancelledBillsOwn.credit}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.institutionCancelledBillsOwn.card}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionCancelledBillsOwn.card}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.institutionCancelledBillsOwn.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionCancelledBillsOwn.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.institutionCancelledBillsOwn.slip}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionCancelledBillsOwn.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                        </p:row>  

                                    </p:columnGroup>  

                                </p:dataTable>

                                <p:spacer height="30"/>

                                <p:dataTable id="OpdBillrefunded" value="#{commonReport.refundedBills.bills}" var="b"
                                             sortBy="#{b.billType}">
                                    <f:facet name="header">  
                                        <h:outputLabel value="Refunded" />
                                    </f:facet> 

                                    <p:column headerText="Time">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.createdAt}" >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.creater.webUserPerson.name}"/>

                                    </p:column>

                                    <p:column headerText="Refunded Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Refunded ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.insId}" ></h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Billed Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.billedBill.insId}" >
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Patient Name" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Patient Name"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.patient.person.nameWithTitle}" >
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Comment" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Comment"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.comments}" ></h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cash'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Credit" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Credit"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Credit'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Credit'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="C Card" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="C Card"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Card'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Card'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Checque" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cheque'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Slip" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Slip'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column>

                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="6" style="text-align:left" footerText="Totals:"/>

                                            <p:column footerText="#{commonReport.institutionRefundedBillsOwn.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionRefundedBillsOwn.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.institutionRefundedBillsOwn.credit}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionRefundedBillsOwn.credit}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.institutionRefundedBillsOwn.card}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionRefundedBillsOwn.card}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>                                          

                                            <p:column footerText="#{commonReport.institutionRefundedBillsOwn.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionRefundedBillsOwn.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column> 

                                            <p:column footerText="#{commonReport.institutionRefundedBillsOwn.slip}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.institutionRefundedBillsOwn.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                        </p:row>  
                                    </p:columnGroup>  

                                </p:dataTable>   

                            </h:panelGroup>

                            <p:spacer height="30"/>

                            <h:panelGroup rendered="#{commonReport.billType eq 'PharmacySale'}" >      
                                <p:dataTable id="PharmacySalebilled"  value="#{commonReport.billedBills.bills}" var="b" 
                                             sortBy="#{b.billType}"  >

                                    <f:facet name="header">  
                                        <h:outputLabel value="Opd Bills "/>
                                    </f:facet>

                                    <p:column headerText="Time"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.createdAt}" >
                                            <f:convertDateTime pattern="h:mm a"/>
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.creater.webUserPerson.name}"/>
                                    </p:column>

                                    <p:column headerText="Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.insId}"/>
                                    </p:column>

                                    <p:column headerText="To Department"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="To Department"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.toDepartment.name}"/>

                                    </p:column>

                                    <p:column headerText="Patient Name" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Patient Name"/>
                                        </f:facet> 
                                        <h:outputLabel value=" #{b.patient.person.nameWithTitle}"/>               
                                    </p:column>

                                    <p:column headerText="Dis." styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Dis."/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.discount}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cash'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cash'}" value="0.00" />
                                    </p:column>

                                    <p:column headerText="Credit" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Credit"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Credit'}" value="#{b.netTotal}"  >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Credit'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="C Card" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="C Card"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Card'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Card'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Checque" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cheque'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Slip" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Slip'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Remark" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Remark"/>
                                        </f:facet> 
                                        <h:outputLabel value="Cancelled. (#{b.cancelledBill.insId})" rendered="#{b.cancelled==true}" ></h:outputLabel>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row >  
                                            <p:column colspan="6" style="text-align:left" footerText="Totals:"/>

                                            <p:column footerText="#{commonReport.billedBills.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.credit}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.credit}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>  


                                            <p:column footerText="#{commonReport.billedBills.card}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.card}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>  

                                            <p:column footerText="#{commonReport.billedBills.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column> 

                                            <p:column footerText="#{commonReport.billedBills.slip}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                        </p:row>  
                                    </p:columnGroup>  

                                </p:dataTable>

                                <p:spacer height="30"/>

                                <p:dataTable id="PharmacySalecancelled"  value="#{commonReport.cancellededBills.bills}" var="b1"  
                                             >
                                    <f:facet name="header">  
                                        <h:outputLabel value="Cancelled"/>
                                    </f:facet> 
                                    <p:column headerText="Time">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.createdAt}" >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>
                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.creater.webUserPerson.name}"/>

                                    </p:column>
                                    <p:column headerText="Cancelled Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cancelled ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.insId}"/>
                                    </p:column>

                                    <p:column headerText="Billed Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.billedBill.insId}" >
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Patient Name" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Patient Name"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.patient.person.nameWithTitle}"/>

                                    </p:column>
                                    <p:column headerText="Comment" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Comment"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b1.comments}"/>

                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Cash'}" value="#{b1.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>
                                    <p:column headerText="Credit"  styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Credit"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Credit'}" value="#{b1.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Credit'}" value="0.00"/>

                                    </p:column>
                                    <p:column headerText="C Card" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="C Card"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Card'}" value="#{b1.netTotal}"  >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Card'}" value="0.00"/>
                                    </p:column>
                                    <p:column headerText="Checque" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Cheque'}" value="#{b1.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Slip" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b1.paymentMethod=='Slip'}" value="#{b1.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b1.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column>
                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  

                                        <p:row>  
                                            <p:column colspan="6" style="text-align:left" footerText="Totals:">

                                            </p:column>
                                            <p:column footerText="#{commonReport.cancellededBills.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>

                                            </p:column>                                                           
                                            <p:column footerText="#{commonReport.cancellededBills.credit}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.credit}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>                   
                                            <p:column footerText="#{commonReport.cancellededBills.card}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.card}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>  
                                            <p:column footerText="#{commonReport.cancellededBills.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column> 
                                            <p:column footerText="#{commonReport.cancellededBills.slip}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>                                                                 
                                        </p:row>  

                                    </p:columnGroup>  

                                </p:dataTable>

                                <p:spacer height="30"/>

                                <p:dataTable id="PharmacySalerefunded" value="#{commonReport.refundedBills.bills}" var="b" sortBy="#{b.billType}"  >
                                    <f:facet name="header">  
                                        <h:outputLabel value="Refunded" />
                                    </f:facet> 
                                    <p:column headerText="Time">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.createdAt}" >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.creater.webUserPerson.name}"/>

                                    </p:column>

                                    <p:column headerText="Refunded Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Refunded ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.insId}" ></h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Billed Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.billedBill.insId}" >
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Patient Name" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Patient Name"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.patient.person.nameWithTitle}" >
                                        </h:outputLabel>

                                    </p:column>
                                    <p:column headerText="Comment" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Comment"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.comments}" ></h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cash'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Credit" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Credit"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Credit'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Credit'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="C Card" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="C Card"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Card'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Card'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Checque" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cheque'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Slip" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Slip'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column>

                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="6" style="text-align:left" footerText="Totals:"/>  
                                            <p:column footerText="#{commonReport.refundedBills.cash}">  
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.refundedBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>
                                            <p:column footerText="#{commonReport.refundedBills.credit}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.refundedBills.credit}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>
                                            <p:column footerText="#{commonReport.refundedBills.card}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.refundedBills.card}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>
                                            <p:column footerText="#{commonReport.refundedBills.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.refundedBills.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>
                                            <p:column footerText="#{commonReport.refundedBills.slip}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.refundedBills.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>
                                        </p:row>  
                                    </p:columnGroup>  

                                </p:dataTable>

                            </h:panelGroup>

                            <p:spacer height="30"/>

                            <h:panelGroup rendered="#{commonReport.billType eq 'PaymentBill'}">
                                <p:dataTable id="PaymentBillbilled" value="#{commonReport.billedBills.bills}" var="b" 
                                             sortBy="#{b.billType}"  >
                                    <f:facet name="header">  
                                        <h:outputLabel value="Payments"/>
                                    </f:facet> 

                                    <p:column headerText="Time" rendered="#{commonReport.fromDate ne commonReport.toDate}"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.createdAt}"  >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>   

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.creater.webUserPerson.name}"/>
                                    </p:column>

                                    <p:column headerText="Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Id"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.insId}"/>
                                    </p:column>

                                    <p:column headerText="Paid to"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Paid To"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.staff.person.nameWithTitle}"/>
                                    </p:column>

                                    <p:column headerText="Cash" style=" text-align: right" rendered="#{commonReport.institutionPaymentBillsOwn.cash!=0.0}"  >
                                        <f:facet name="footer">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cash'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>

                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="4" style="text-align:left" footerText="Totals:"/>  
                                            <p:column footerText="#{commonReport.billedBills.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>                      
                                        </p:row>  
                                    </p:columnGroup>

                                </p:dataTable>

                                <p:spacer height="30"/>

                                <p:dataTable id="PaymentBillcancelled"
                                             value="#{commonReport.cancellededBills.bills}"
                                             var="b"   sortBy="#{b.billType}"  >
                                    <f:facet name="header">  
                                        <h:outputLabel value="Payments Cancel" />
                                    </f:facet> 

                                    <p:column headerText="Time" rendered="#{commonReport.fromDate ne commonReport.toDate}"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Payments Cancel" />
                                        </f:facet>
                                        <h:outputLabel value="#{b.createdAt}"  >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.creater.webUserPerson.name}"/>
                                    </p:column>

                                    <p:column headerText="Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Id" />
                                        </f:facet>
                                        <h:outputLabel value="#{b.insId}"/>
                                    </p:column>

                                    <p:column headerText="For Wich Staff"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="For Which Staff" />
                                        </f:facet>
                                        <h:outputLabel value="#{b.staff.person.nameWithTitle}"/>
                                    </p:column>

                                    <p:column headerText="Comment"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Comment" />
                                        </f:facet>
                                        <h:outputLabel value="#{b.comments}"/>                           
                                    </p:column>

                                    <p:column headerText="Cash" style=" text-align: right" rendered="#{commonReport.institutionPaymentCancelBillsOwn.cash!=0.0}"  >
                                        <f:facet name="footer">  
                                            <h:outputLabel value="Cash" />
                                        </f:facet>
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cash'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>

                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="5" style="text-align:left" footerText="Totals:"/>  
                                            <p:column footerText="#{commonReport.cancellededBills.cash}"/>                    
                                        </p:row>  
                                    </p:columnGroup> 
                                </p:dataTable>

                                <p:dataTable id="PaymentBillrefunded"
                                             value="#{commonReport.blankBills}"
                                             var="b"    >
                                </p:dataTable>

                            </h:panelGroup>

                            <p:spacer height="30"/>

                            <h:panelGroup rendered="#{commonReport.billType eq 'PettyCash'}">
                                <p:dataTable id="PettyCashbilled" value="#{commonReport.billedBills.bills}"
                                             var="b4"   sortBy="#{b4.billType}">
                                    <f:facet name="header">  
                                        <h:outputLabel value="Petty Cash Payment"/>
                                    </f:facet>

                                    <p:column headerText="Time" style="width:16%; " >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b4.createdAt}" >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b4.creater.webUserPerson.name}"/>
                                    </p:column>

                                    <p:column headerText="Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Id"/>
                                        </f:facet>
                                        <h:outputLabel value=" #{b4.insId}"/>
                                    </p:column>

                                    <p:column headerText="For Whome"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="For Whom"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b4.staff.person.nameWithTitle}" rendered="#{b4.person eq null}"/>
                                        <h:outputLabel value="#{b4.person.nameWithTitle}" rendered="#{b4.person ne null}"/>
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b4.paymentMethod=='Cash'}" value="#{b4.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b4.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Cheque" styleClass="averageNumericColumn"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b4.paymentMethod=='Cheque'}" value="#{b4.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b4.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>    

                                    <p:column headerText="Descripion"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Description"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b4.comments}"/>
                                    </p:column>

                                    <p:column headerText="Invoice" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Invoice"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b4.invoiceNumber}"/>
                                    </p:column>

                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="4" style="text-align:left" footerText="Totals:"/>

                                            <p:column footerText="#{commonReport.billedBills.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                        </p:row>  
                                    </p:columnGroup> 
                                </p:dataTable>

                                <p:spacer height="30"/>


                                <p:dataTable id="PettyCashcancelled" value="#{commonReport.cancellededBills.bills}" 
                                             var="b4"   sortBy="#{b4.billType}" >
                                    <f:facet name="header">  
                                        <h:outputLabel  value="Petty Cash Payment Cancel"/>
                                    </f:facet>

                                    <p:column headerText="Time" style="width:16%; " >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b4.createdAt}" >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.creater.webUserPerson.name}"/>
                                    </p:column>

                                    <p:column headerText="Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b4.insId}"/>
                                    </p:column>

                                    <p:column headerText="For Whome" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="For Whom"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b4.staff.person.nameWithTitle}" rendered="#{b4.person eq null}"/>
                                        <h:outputLabel value="#{b4.person.nameWithTitle}" rendered="#{b4.person ne null}"/>
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b4.paymentMethod=='Cash'}" value="#{b4.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b4.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Cheque" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b4.paymentMethod=='Cheque'}" value="#{b4.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b4.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Descripion" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Description"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b4.comments}"/>
                                    </p:column>

                                    <p:column headerText="Billed Id"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b4.billedBill.insId}" >
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Billed Date/Time"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed Date/Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b4.billedBill.createdAt}" >
                                            <f:convertDateTime pattern="#{sessionController.applicationPreference.longDateTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="4" style="text-align:left" footerText="Totals:"/>  
                                            <p:column footerText="#{commonReport.cancellededBills.cash}">

                                            </p:column>                  
                                            <p:column footerText="#{commonReport.cancellededBills.cheque}"/>                  
                                        </p:row>  
                                    </p:columnGroup>

                                </p:dataTable>

                                <p:dataTable id="PettyCashrefunded"
                                             value="#{commonReport.blankBills}"
                                             var="b"    >
                                </p:dataTable>

                            </h:panelGroup>

                            <p:spacer height="30"/>



                            <h:panelGroup rendered="#{commonReport.billType eq 'CashRecieveBill'}">
                                <p:dataTable id="CashRecieveBillbilled" value="#{commonReport.billedBills.bills}"
                                             var="b7"   sortBy="#{b7.billType}" >
                                    <f:facet name="header">  
                                        <h:outputLabel value="Credit Company Payment Recieve"/>
                                    </f:facet> 

                                    <p:column headerText="Time" style="width:16%; ">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.createdAt}" >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.creater.webUserPerson.name}"/>
                                    </p:column>

                                    <p:column headerText="Id"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.insId}" />
                                    </p:column>

                                    <p:column headerText="Credit Company"  > 
                                        <f:facet name="header">  
                                            <h:outputLabel value="Credit Company"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.fromInstitution.name}" />
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Cash'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Cheque" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Cheque'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Slip" styleClass="averageNumericColumn"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Slip'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column>

                                    <p:column headerText="Descripion" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Descripion"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.comments}" />
                                    </p:column>                                               

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="4" style="text-align:left" footerText="Totals:"/>  

                                            <p:column footerText="#{commonReport.billedBills.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.cheque}">                                    
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet> 
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.slip}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column> 
                                        </p:row>  
                                    </p:columnGroup> 
                                </p:dataTable>

                                <p:spacer height="30"/>

                                <p:dataTable id="CashRecieveBillcancelled" value="#{commonReport.cancellededBills.bills}"
                                             var="b7"   sortBy="#{b7.billType}" 
                                             rendered="#{commonReport.cancellededBills.bills.size()>0}">
                                    <f:facet name="header">  
                                        <h:outputLabel value="Credit Company Payment Cancel"/>
                                    </f:facet> 
                                    <p:column headerText="Time" style="width:16%; " >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.createdAt}" >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.creater.webUserPerson.name}"/>

                                    </p:column>

                                    <p:column headerText="Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.insId}"/>
                                    </p:column>

                                    <p:column headerText="Credit Company"  >   
                                        <f:facet name="header">  
                                            <h:outputLabel value="Credit Company"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.fromInstitution.name}" />
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Cash'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>   

                                    <p:column headerText="Cheque" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Cheque'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>    

                                    <p:column headerText="Slip" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet> 
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Slip'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column>    

                                    <p:column headerText="Descripion"  style="">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Descripion"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.comments}" />
                                    </p:column>    
                                    <p:column headerText="Billed Id" style="" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed ID"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.billedBill.insId}" >
                                        </h:outputLabel>
                                    </p:column>
                                    <p:column headerText="Billed Date/Time" style="" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed Date/Time"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.billedBill.createdAt}" >
                                            <f:convertDateTime pattern="#{sessionController.applicationPreference.longDateTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>
                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="4" style="text-align:left" footerText="Totals:"/>

                                            <p:column footerText="#{commonReport.cancellededBills.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.cancellededBills.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>                                
                                            </p:column>   

                                            <p:column footerText="#{commonReport.cancellededBills.slip}">                                
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column> 

                                        </p:row>  
                                    </p:columnGroup>
                                </p:dataTable>


                                <p:dataTable id="CashRecieveBillrefunded"
                                             value="#{commonReport.blankBills}"
                                             var="b"    >
                                </p:dataTable>
                            </h:panelGroup>

                            <p:spacer height="30"/>

                            <h:panelGroup rendered="#{commonReport.billType eq 'AgentPaymentReceiveBill'}">

                                <p:dataTable id="AgentPaymentReceiveBillbilled" value="#{commonReport.billedBills.bills}" 
                                             var="b7"   sortBy="#{b7.billType}">
                                    <f:facet name="header">  
                                        <h:outputLabel value="Cashier Agent Payment Detail Report"/>
                                    </f:facet> 


                                    <p:column headerText="Cashier Name"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier Name"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.creater.webUserPerson.name}"/>

                                    </p:column>

                                    <p:column headerText="Id"  style="">
                                        <f:facet name="header">  
                                            <h:outputLabel value="ID"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.insId}"/>
                                    </p:column>

                                    <p:column headerText="Date And Time" style="width:16%; ">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Date And Time"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.createdAt}" >
                                            <f:convertDateTime pattern="#{sessionController.applicationPreference.longDateTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>


                                    <p:column headerText="Agent Name"  style="">      
                                        <f:facet name="header">  
                                            <h:outputLabel value="Agent Name"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.fromInstitution.name}" />
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet>
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Cash'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>    
                                    <p:column headerText="Cheque" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet>
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Cheque'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column>  
                                    <p:column headerText="Slip" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet>
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Slip'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column>  
                                    <p:column headerText="Descripion"  style="">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Descripion"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.comments}" />
                                    </p:column>                                               

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="4" style="text-align:left" footerText="Totals:"/>

                                            <p:column footerText="#{commonReport.billedBills.cash}">                                    
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.billedBills.slip}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column> 

                                        </p:row>  
                                    </p:columnGroup> 

                                </p:dataTable>

                                <p:spacer height="30"/>

                                <p:dataTable id="AgentPaymentReceiveBillcancelled"  value="#{commonReport.cancellededBills.bills}"
                                             var="b7"   sortBy="#{b7.billType}">
                                    <f:facet name="header">  
                                        <h:outputLabel value="Agent Payment Cancel"/>
                                    </f:facet>

                                    <p:column headerText="Time" style="width:16%; " >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.createdAt}" >
                                            <f:convertDateTime pattern="#{sessionController.applicationPreference.longDateTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b7.creater.webUserPerson.name}"/>
                                    </p:column>

                                    <p:column headerText="Id"  style="">
                                        <f:facet name="header">  
                                            <h:outputLabel value="ID"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.insId}"/>
                                    </p:column>

                                    <p:column headerText="Agent"  style=""> 
                                        <f:facet name="header">  
                                            <h:outputLabel value="Agent"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.fromInstitution.name}" />
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet>
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Cash'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>    

                                    <p:column headerText="Cheque" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cheque"/>
                                        </f:facet>
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Cheque'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Cheque'}" value="0.00"/>
                                    </p:column> 

                                    <p:column headerText="Slip" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Slip"/>
                                        </f:facet>
                                        <h:outputLabel rendered="#{b7.paymentMethod=='Slip'}" value="#{b7.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b7.paymentMethod!='Slip'}" value="0.00"/>
                                    </p:column> 

                                    <p:column headerText="Descripion"  style="">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Descripion"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.comments}"/>
                                    </p:column>

                                    <p:column headerText="Billed Id" style="" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed ID"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.billedBill.insId}" >
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Billed Date/Time" style="" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Billed Date/Time"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b7.billedBill.createdAt}" >
                                            <f:convertDateTime pattern="#{sessionController.applicationPreference.longDateTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="4" style="text-align:left" footerText="Totals:"/>  

                                            <p:column footerText="#{commonReport.cancellededBills.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>                  

                                            <p:column footerText="#{commonReport.cancellededBills.cheque}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.cheque}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                            <p:column footerText="#{commonReport.cancellededBills.slip}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.slip}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>

                                        </p:row>                   
                                    </p:columnGroup> 
                                </p:dataTable>

                                <p:dataTable id="AgentPaymentReceiveBillrefunded"
                                             value="#{commonReport.blankBills}"
                                             var="b"    >
                                </p:dataTable>

                            </h:panelGroup>

                            <p:spacer height="30"/>

                            <h:panelGroup rendered="#{commonReport.billType eq 'InwardPaymentBill'}">

                                <p:dataTable id="InwardPaymentBillbilled" value="#{commonReport.billedBills.bills}" 
                                             var="b"   sortBy="#{b.billType}"
                                             rendered="#{commonReport.billedBills.bills.size()>0}" >
                                    <f:facet name="header">  
                                        <h:outputLabel value="Inward Payments" />
                                    </f:facet> 
                                    <p:column headerText="Time" rendered="#{commonReport.fromDate ne commonReport.toDate}"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b.createdAt}"  >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>     
                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.creater.webUserPerson.name}"/>

                                    </p:column>
                                    <p:column headerText="Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="ID"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b.insId}"/>
                                    </p:column>
                                    <p:column headerText="Bht No"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="BHT No"/>
                                        </f:facet>
                                        <h:outputLabel  value="#{b.patientEncounter.bhtNo}"/>
                                    </p:column>
                                    <p:column headerText="Patient"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Patient"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b.patient.person.nameWithTitle}"/>
                                    </p:column>
                                    <p:column headerText="Cash" styleClass="averageNumericColumn" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cash"/>
                                        </f:facet>
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cash'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>
                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="5" style="text-align:left" footerText="Totals:"/>  
                                            <p:column footerText="#{commonReport.billedBills.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.billedBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>               
                                        </p:row>                   
                                    </p:columnGroup> 
                                </p:dataTable>

                                <p:spacer height="30"/>

                                <p:dataTable id="InwardPaymentBillcancelled" value="#{commonReport.cancellededBills.bills}" 
                                             var="b"   sortBy="#{b.billType}">
                                    <f:facet name="header">  
                                        <h:outputLabel value="Inward Payments Cancel"/>
                                    </f:facet> 
                                    <p:column headerText="Time" rendered="#{commonReport.fromDate ne commonReport.toDate}"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b.createdAt}"  >
                                            <f:convertDateTime  timeZone="Asia/Colombo" pattern="#{sessionController.applicationPreference.longTimeFormat}" />
                                        </h:outputLabel>
                                    </p:column>

                                    <p:column headerText="Cashier"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Cashier"/>
                                        </f:facet> 
                                        <h:outputLabel value="#{b.creater.webUserPerson.name}"/>

                                    </p:column>

                                    <p:column headerText="Id" >
                                        <f:facet name="header">  
                                            <h:outputLabel value="ID"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b.insId}"/>
                                    </p:column>

                                    <p:column headerText="Bht No"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="BHT No"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b.patientEncounter.bhtNo}"/>
                                    </p:column>
                                    <p:column headerText="Patient"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Patient"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b.patient.person.nameWithTitle}"/>
                                    </p:column>
                                    <p:column headerText="Comment"  >
                                        <f:facet name="header">  
                                            <h:outputLabel value="Comment"/>
                                        </f:facet>
                                        <h:outputLabel value="#{b.comments}"/>
                                    </p:column>

                                    <p:column headerText="Cash" styleClass="averageNumericColumn">
                                        <f:facet name="header">  
                                            <h:outputLabel value="Time"/>
                                        </f:facet>
                                        <h:outputLabel rendered="#{b.paymentMethod=='Cash'}" value="#{b.netTotal}" >
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                        <h:outputLabel rendered="#{b.paymentMethod!='Cash'}" value="0.00"/>
                                    </p:column>

                                    <p:column exportable="false">
                                        <p:selectBooleanCheckbox style="border: black 2px solid;"/>
                                    </p:column>

                                    <p:columnGroup type="footer">  
                                        <p:row>  
                                            <p:column colspan="6" style="text-align:left" footerText="Totals:"/>  
                                            <p:column footerText="#{commonReport.cancellededBills.cash}">
                                                <f:facet name="footer">
                                                    <h:outputLabel value="#{commonReport.cancellededBills.cash}">
                                                        <f:convertNumber pattern="#,##0.00"/>
                                                    </h:outputLabel>
                                                </f:facet>
                                            </p:column>
                                        </p:row>                   
                                    </p:columnGroup> 
                                </p:dataTable>

                                <p:dataTable id="InwardPaymentBillrefunded"
                                             value="#{commonReport.blankBills}"
                                             var="b"    >
                                </p:dataTable>
                            </h:panelGroup>

                            <p:spacer height="30"/>

                            <p:dataTable id="sum" value="#{commonReport.dataTableDataByType2}"  var="i" >
                                <f:facet name="header">
                                    <h:outputLabel value="Summary" />
                                </f:facet>
                                <p:column>
                                    <h:outputLabel value="#{i.string}"/>
                                </p:column>
                                <p:column style="font-weight: bold;text-align:right;" >
                                    <h:outputLabel value="#{i.value}">
                                        <f:convertNumber pattern="#,##0.00" />
                                    </h:outputLabel>
                                </p:column>
                                <f:facet name="footer">
                                    <h:outputLabel style="float: right" value="Printed By : #{sessionController.loggedUser.webUserPerson.name} " />
                                </f:facet>
                            </p:dataTable>


                        </p:panel>



                    </p:panel>

                </h:form>


            </ui:define>

        </ui:composition>

    </h:body>
</html>
