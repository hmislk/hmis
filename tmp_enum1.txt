 * Open Hospital Management Information System
 * Dr M H B Ariyaratne
 * buddhika.ari@gmail.com
 */
package com.divudi.bean.common;

import com.divudi.core.data.*;
import com.divudi.core.data.ScheduledProcess;
import com.divudi.core.data.ScheduledFrequency;
import com.divudi.core.data.analytics.ReportTemplateColumn;
import com.divudi.core.data.analytics.ReportTemplateFilter;
import com.divudi.core.data.hr.*;
import com.divudi.core.data.inward.AdmissionStatus;
import com.divudi.core.data.inward.AdmissionTypeEnum;
import com.divudi.core.data.inward.InwardChargeType;
import com.divudi.core.data.inward.PatientEncounterComponentType;
import com.divudi.core.data.lab.PatientInvestigationStatus;
import com.divudi.core.data.lab.Priority;
import com.divudi.core.data.lab.SearchDateType;
import com.divudi.core.data.lab.TestHistoryType;
import com.divudi.core.entity.PaymentScheme;
import com.divudi.core.entity.Person;
import com.divudi.service.BillService;
import java.io.Serializable;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.enterprise.context.ApplicationScoped;
import javax.enterprise.context.SessionScoped;
import javax.inject.Inject;
import javax.inject.Named;

/**
 *
 * @author safrin
 */
@Named
@ApplicationScoped
public class EnumController implements Serializable {

    @EJB
    BillService billService;

    @Inject
    ConfigOptionApplicationController configOptionApplicationController;

    private PaymentScheme paymentScheme;
    private List<Class<? extends Enum<?>>> enumList;
    List<PaymentMethod> paymentMethodsForOpdBilling;
    private List<PaymentMethod> paymentMethodsForPharmacyPurchase;
    List<PaymentMethod> paymentMethodsForChanneling;
    List<PaymentMethod> paymentMethodsForChannelSettling;
    List<PaymentMethod> paymentMethodsForPharmacyBilling;
    private List<PaymentMethod> paymentMethodsForMultiplePaymentMethod;
    private List<PaymentMethod> paymentMethodsForPatientDepositRefund;
    private List<PaymentMethod> paymentMethodsForPatientDepositCancel;
    private List<PaymentMethod> paymentMethodsForStaffCreditSettle;
    private List<PaymentMethod> paymentMethodsForPatientDeposit;
    private List<PaymentMethod> paymentMethodsForOpdBillCanceling;
    SessionNumberType[] sessionNumberTypes;
    private List<PatientInvestigationStatus> patientInvestigationStatuses;
    private List<PaymentMethod> paymentTypeOfPaymentMethods;

    private List<PatientInvestigationStatus> availableStatusforCancel;

    private List<BillTypeAtomic> allUtilizedBillTypeAtomics;
    private List<BillTypeAtomic> allUtilizedBillTypeAtomicsForPharmacy;

    @PostConstruct
    public void init() {
        enumList = new ArrayList<>();
        enumList.add(PaymentMethod.class);
        enumList.add(PaperType.class);
        enumList.add(ItemType.class);
        enumList.add(DiscountType.class);
    }
    

    public Sex[] getSex() {
        return Sex.values();
    }

    public List<PaymentMethod> getPaymentMethodsForOpdBilling() {
        if (paymentMethodsForOpdBilling == null) {
            fillPaymentMethodsForOpdBilling();
        }
        return paymentMethodsForOpdBilling;
    }

    public List<PaymentMethod> getPaymentMethodsForPackageBilling() {
        if (paymentMethodsForOpdBilling == null) {
            fillPaymentMethodsForPackageBilling();
        }
        return paymentMethodsForOpdBilling;
    }

    public List<PaymentMethod> getPaymentMethodsForPackageBillingWIthoutMultiple() {
        if (paymentMethodsForOpdBilling == null) {
            fillPaymentMethodsForPackageBilling();
        }
        try {
            paymentMethodsForOpdBilling.remove(PaymentMethod.MultiplePaymentMethods);
        } catch (Exception e) {

        }
        return paymentMethodsForOpdBilling;
    }

    public void resetPaymentMethods() {
        paymentMethodsForOpdBilling = null;
        paymentMethodsForChanneling = null;
    }

    public void fillPaymentMethodsForPatientDeposit() {
        paymentMethodsForPatientDeposit = new ArrayList<>();
        for (PaymentMethod pm : PaymentMethod.values()) {
            boolean include = configOptionApplicationController.getBooleanValueByKey(pm.getLabel() + " is available for Patient Deposit", true);
            if (include) {
                paymentMethodsForPatientDeposit.add(pm);
            }
        }
    }

    public void fillPaymentMethodsForOpdBilling() {
        paymentMethodsForOpdBilling = new ArrayList<>();
        for (PaymentMethod pm : PaymentMethod.values()) {
            boolean include = configOptionApplicationController.getBooleanValueByKey(pm.getLabel() + " is available for OPD Billing", true);
            if (include) {
                paymentMethodsForOpdBilling.add(pm);
            }
        }
    }

    public void fillPaymentMethodsFoPharmacyPurchase() {
        paymentMethodsForPharmacyPurchase = new ArrayList<>();
        for (PaymentMethod pm : PaymentMethod.values()) {
            boolean include = configOptionApplicationController.getBooleanValueByKey(pm.getLabel() + " is available for Pharmacy Purchase", true);
            if (include) {
                paymentMethodsForPharmacyPurchase.add(pm);
            }
        }
    }

    public void fillPaymentMethodsForPackageBilling() {
        paymentMethodsForOpdBilling = new ArrayList<>();
        for (PaymentMethod pm : PaymentMethod.values()) {
            boolean include = configOptionApplicationController.getBooleanValueByKey(pm.getLabel() + " is available for Package Billing", true);
            if (include) {
                paymentMethodsForOpdBilling.add(pm);
            }
        }
    }

    public List<PaymentMethod> getPaymentMethodsForChanneling() {
        if (paymentMethodsForChanneling == null) {
            fillPaymentMethodsForChanneling();
        }
        return paymentMethodsForChanneling;
    }

    public List<InvestigationReportType> getInvestigationReportTypes() {
        return Arrays.asList(InvestigationReportType.values());
    }

    public List<PaymentMethod> getPaymentMethodsForChannelSettling() {
        if (paymentMethodsForChannelSettling == null) {
            fillPaymentMethodsForChannelSettling();
        }
        return paymentMethodsForChannelSettling;
    }

    public void fillPaymentMethodsForChanneling() {
        paymentMethodsForChanneling = new ArrayList<>();
        for (PaymentMethod pm : PaymentMethod.values()) {
            boolean include = configOptionApplicationController.getBooleanValueByKey(pm.getLabel() + " is available for Channeling", true);
            if (include) {
                paymentMethodsForChanneling.add(pm);
            }
        }
    }

    public void fillPaymentMethodsForChannelSettling() {
        paymentMethodsForChannelSettling = new ArrayList<>();
        for (PaymentMethod pm : PaymentMethod.values()) {
            if (!pm.equals(PaymentMethod.OnCall)) {
                boolean include = configOptionApplicationController.getBooleanValueByKey(pm.getLabel() + " is available for Channeling", true);
                if (include) {
                    paymentMethodsForChannelSettling.add(pm);
                }
            }
        }
    }

    public List<PaymentMethod> getPaymentMethodsForPharmacyBilling() {
        if (paymentMethodsForPharmacyBilling == null) {
            fillPaymentMethodsForPharmacyBilling();
        }
        return paymentMethodsForPharmacyBilling;
    }

    public List<PaymentMethod> getPaymentMethodsForPharmacyBillCancellations() {
        List<PaymentMethod> paymentMethodsForPharmacyBillCancellations = new ArrayList<>();
        if (paymentMethodsForPharmacyBilling == null) {
            fillPaymentMethodsForPharmacyBilling();
        }
        if (paymentMethodsForPharmacyBilling == null) {
            paymentMethodsForPharmacyBilling = new ArrayList<>();
        }
        if (paymentMethodsForPharmacyBilling.isEmpty()) {
            paymentMethodsForPharmacyBilling.add(PaymentMethod.Cash);
            paymentMethodsForPharmacyBilling.add(PaymentMethod.Card);
        }
        paymentMethodsForPharmacyBillCancellations.addAll(paymentMethodsForPharmacyBilling);
        try {
            paymentMethodsForPharmacyBillCancellations.remove(PaymentMethod.MultiplePaymentMethods);
        } catch (Exception e) {
