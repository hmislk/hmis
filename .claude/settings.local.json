{
  "permissions": {
    "allow": [
      "Bash(gh api:*)",
      "WebFetch(domain:github.com)",
      "Bash(git clone:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(mkdir:*)",
      "Bash(chmod:*)",
      "Bash(cp:*)",
      "Bash(git rm:*)",
      "Bash(scriptssync-wiki.bat)",
      "Bash(scripts/sync-wiki.sh:*)",
      "Bash(scriptssafe-push.bat)",
      "Bash(scripts/safe-push.sh:*)",
      "Bash(.scriptssafe-push.bat)",
      "Bash(cmd /c:*)",
      "Bash(./scripts/safe-push.sh:*)",
      "Bash(sed:*)",
      "Bash(powershell:*)",
      "Bash(gh pr create:*)",
      "Bash(git fetch:*)",
      "Bash(scripts/sync-wiki.bat)",
      "Bash(scripts/safe-push.bat)",
      "Bash(git pull:*)",
      "Bash(sync-wiki.bat)",
      "Bash(./scripts/sync-wiki.bat)",
      "Bash(rm:*)",
      "Bash(scriptsprepare-for-push.bat)",
      "Bash(del .jndi-backup-main .jndi-backup-audit)",
      "Bash(gh pr list:*)",
      "Bash(gh pr comment:*)",
      "Bash(gh repo view:*)",
      "Bash(./scripts/sync-wiki.sh:*)",
      "Bash(call:*)",
      "Bash(./detect-maven.sh clean:*)",
      "Bash(./detect-maven.sh:*)",
      "Bash(mysql:*)",
      "Bash(mvn compile:*)",
      "Bash(git merge:*)",
      "Bash(gh issue list:*)",
      "Bash(grep:*)",
      "Bash(find:*)",
      "Bash(git log:*)",
      "Bash(gh issue view:*)",
      "Bash(javac:*)",
      "Bash(del /s /q wiki-temp)",
      "Bash(gh pr view:*)",
      "Bash(gh issue comment:*)",
      "Bash(gh issue close:*)",
      "Bash(awk:*)",
      "Bash(gh workflow run:*)",
      "Bash(gh run list:*)",
      "Bash(gh pr merge:*)",
      "Read(/D:\\tmp/**)",
      "Read(/D:\\c/**)",
      "Bash(gh workflow:*)",
      "Read(/D:\\c/**)",
      "Bash(git checkout:*)",
      "Bash(javap:*)",
      "Bash(git branch:*)",
      "Bash(pip install:*)",
      "Bash(python:*)",
      "Bash(gh issue create --title \"Pharmacy Search Sale Pre-Bill page showing no results after DTO implementation due to missing COALESCE in JPQL query\" --body \"$(cat <<''EOF''\n## Problem Description\n\nThe pharmacy search sale pre-bill page (`http://localhost:8080/rh/faces/pharmacy/pharmacy_search_sale_pre_bill.xhtml`) is not listing any bills after being updated to use DTOs in SearchController.createPharmacyTableReDto().\n\n## Root Cause\n\nThe JPQL query in `SearchController.createPharmacyTableReDto()` (SearchController.java:3513-3644) has missing COALESCE statements for several fields that can be NULL when LEFT JOINed entities don''t exist. This causes issues when constructing the PharmacyCashierPreBillSearchDTO.\n\n## Affected Code Files\n\n1. **SearchController.java:3513-3644** - `createPharmacyTableReDto()` method\n2. **PharmacyCashierPreBillSearchDTO.java** - DTO constructor\n3. **pharmacy_search_sale_pre_bill.xhtml** - Frontend page\n\n## Specific Issues in JPQL Query\n\nThe following fields in the SELECT statement lack COALESCE and can return NULL when related entities don''t exist:\n\n### Boolean Fields (should have COALESCE to false)\n- `b.refunded` → should be `COALESCE(b.refunded, false)`\n- `b.retired` → should be `COALESCE(b.retired, false)` \n- `b.cancelled` → should be `COALESCE(b.cancelled, false)`\n- `refb.cancelled` → should be `COALESCE(refb.cancelled, false)`\n- `refb.refunded` → should be `COALESCE(refb.refunded, false)`\n\n### Date Fields (should have COALESCE to null or appropriate default)\n- `rb.createdAt` → should be `COALESCE(rb.createdAt, NULL)`\n- `cb.createdAt` → should be `COALESCE(cb.createdAt, NULL)`\n- `b.retiredAt` → should be `COALESCE(b.retiredAt, NULL)`\n- `refb.createdAt` → should be `COALESCE(refb.createdAt, NULL)`\n- `refcb.createdAt` → should be `COALESCE(refcb.createdAt, NULL)`\n- `refrb.createdAt` → should be `COALESCE(refrb.createdAt, NULL)`\n\n### ID Fields (should have COALESCE to null)\n- `refb.id` → should be `COALESCE(refb.id, NULL)`\n\n### String Fields (should have COALESCE to empty string)\n- `refb.deptId` → should be `COALESCE(refb.deptId, '''')`\n\n## Expected Result\n\nAfter implementing proper COALESCE statements:\n1. Bills should display correctly in the data table\n2. NULL-related entity properties should not cause DTO construction failures\n3. Search functionality should work as expected\n\n## Steps to Reproduce\n\n1. Navigate to pharmacy search sale pre-bill page\n2. Set date range and click Search\n3. Observe that no bills are listed despite having valid pre-bills in the database\n\n## Priority\n\nHigh - This affects core pharmacy workflow functionality for cashier pre-bill searches.\n\n## Technical Context\n\n- The page was recently updated from entity-based queries to DTO-based queries for performance optimization\n- The DTO constructor requires proper handling of NULL values from LEFT JOINed entities\n- Missing COALESCE statements cause the query to return NULL values that break DTO construction\n\nEOF\n)\")"
    ],
    "deny": [],
    "defaultMode": "acceptEdits",
    "additionalDirectories": [
      "D:\\Development"
    ]
  }
}
