////                case OpdBathcBillPre:
////                    opdPreBatchBillSettleController.setPreBill(preBill);
////                    return "/opd/opd_bill_pre_settle?faces-redirect=true";
//                default:
//                    throw new AssertionError();
//            }
//
//        }
        JsfUtil.addErrorMessage("No bill error");
        return null;
    }

    public void setPreBillForOpd(Bill preBill) {
        makeNull();
        opdPreSettleController.setPreBill(preBill);

        opdPreSettleController.toSettle(preBill);

        opdPreSettleController.setBillPreview(false);

    }

    public void setPreBillForPharmecy(Bill preBill) {
        makeNull();
        pharmacyPreSettleController.setPreBill(preBill);

        pharmacyPreSettleController.setBillPreview(false);

    }

    public void createGrnWithDealerTable() {
        Map params = new HashMap();
        String jpql = "select b "
                + " from Bill b "
                + " where b.retired=false "
                + " and b.billType = :billType "
                + " and b.createdAt between :fromDate and :toDate ";

        if(getDealer()!=null){
            jpql += " and b.institution = :del ";
            params.put("del", getDealer());
        }
        
        params.put("billType", BillType.PharmacyGrnBill);
        
        params.put("toDate", getToDate());
        params.put("fromDate", getFromDate());

        grnBills = getBillFacade().findByJpql(jpql, params, TemporalType.TIMESTAMP);
    }

    public void fillSavedTranserRequestBills() {

        String sql = "Select bill from Bill bill where bill.retired =false "
                + " and bill.billType = :billType "
                + " and bill.institution = :institution "
                + " and bill.fromDepartment = :fromDepartment "
                + " and bill.createdAt between :fromDate and :toDate"
                + " order by bill.createdAt desc";

        Map parametersForSearching = new HashMap();
        parametersForSearching.put("billType", BillType.PharmacyTransferRequest);
        parametersForSearching.put("institution", sessionController.getInstitution());
        parametersForSearching.put("fromDepartment", sessionController.getDepartment());
        parametersForSearching.put("fromDate", getFromDate());
        parametersForSearching.put("toDate", getToDate());

        bills = getBillFacade().findByJpql(sql, parametersForSearching, TemporalType.TIMESTAMP);

    }

    public String navigateToPatientLabReports() {
        fillPatientLabReports(patient);
        return "/lab/patient_lab_reports";
    }

    public String navigateToPatientAcceptPayment() {
        fillPatientPreBills(null, patient, null, true);
        return "/opd/patient_accept_payment";
    }

    public String menuBarSearch() {
        JsfUtil.addSuccessMessage("Sarched From Menubar" + "\n" + menuBarSearchText);
        return "/index";
    }

    public String navigateToSmsList() {
        return "/analytics/sms_list?faces-redirect=true";
    }

    public String navigateToBillList() {
        resetAllFiltersExceptDateRange();
        return "/analytics/bills?faces-redirect=true";
    }

    public String navigateToCancellationBillList() {
        resetAllFiltersExceptDateRange();
        return "/analytics/cancellation_bills?faces-redirect=true";
    }

    public String navigateToReturnBillList() {
        resetAllFiltersExceptDateRange();
        return "/analytics/return_bills?faces-redirect=true";
    }

    public String navigateToPharmaceuticalBillItemList() {
        resetAllFiltersExceptDateRange();
        return "/analytics/pharmaceutical_bill_items?faces-redirect=true";
    }

    public String navigateToPatientInvestigationList() {
        resetAllFiltersExceptDateRange();
        return "/analytics/patient_investigations?faces-redirect=true";
    }

    public String navigateToBillListFromBill(Bill bill) {
        resetAllFilters();
        fromDate = CommonFunctions.getStartOfBeforeDay(bill.getCreatedAt());
        toDate = CommonFunctions.getEndOfDay(bill.getCreatedAt());
        webUser = bill.getCreater();
        institution = bill.getInstitution();
        department = bill.getDepartment();
        if (bill.getDepartment() != null) {
            site = bill.getDepartment().getSite();
        }
        billTypeAtomic = bill.getBillTypeAtomic();
        billType = bill.getBillType();
        listBills();
        return "/analytics/bills?faces-redirect=true";
    }

    public String navigateToBillTypeList() {
        resetAllFiltersExceptDateRange();
        return "/analytics/bill_types?faces-redirect=true";
    }

    public String navigateToUserBillTypeList(WebUser wu) {
        resetAllFiltersExceptDateRange();
        webUser = wu;
        listBillTypes();
        return "/analytics/bill_types?faces-redirect=true";
    }

    public String navigateToUserBillPaymentList(WebUser wu) {
        billSummaryRows = null;
        resetAllFiltersExceptDateRange();
        resetTotals();
        webUser = wu;
        listPayments();
        return "/analytics/payments?faces-redirect=true";
    }

    public String navigateToUserBillList(WebUser wu) {
        resetAllFiltersExceptDateRange();
        webUser = wu;
        listBills();
        return "/analytics/bills?faces-redirect=true";
    }

    public String navigateToBillItemList() {
